import os
import json
import time
import threading
import html
from datetime import datetime

import subprocess
import sys

def ensure_package(import_name, pip_name=None):
    if pip_name is None:
        pip_name = import_name
    try:
        __import__(import_name)
        return False  # No installation needed
    except ImportError:
        confirmation = input(f"{pip_name} not found. Install it? (y/n): ")
        if confirmation.lower() != 'y':
            print(f"Cannot continue without {pip_name}. Exiting. Press 'Enter' to exit.")
            input()
            sys.exit(1)
            
        print(f"Installing {pip_name}...")
        subprocess.check_call(
            [sys.executable, "-m", "pip", "install", "--quiet", pip_name],
            stdout=subprocess.DEVNULL,
            stderr=subprocess.DEVNULL
        )
        return True  # Installation was needed

# Track if anything was installed
installed_anything = False

installed_anything |= ensure_package('tqdm')
installed_anything |= ensure_package('win32api', 'pywin32')

# If we installed anything, ask the user to rerun
if installed_anything:
    input("\nInstallation complete. Please run the script again.\nPress 'Enter' to exit.")
    sys.exit()

# Now safe to import
from tqdm import tqdm
import win32api

# Use default icon preset for undefined file types
USE_DEFAULT_PRESET = False

# Define preset icons for different file types
ICON_PRESETS = {
    'default': ['accurip', 'ass', 'bin', 'cfg', 'cue', 'm3u', 'iso', 'ISO', 'mds', 'MDS', 'xspf'],
    'video': ['avi', 'f4v', 'flv', 'm4v', 'mkv', 'mov', 'mp4', 'MP4', 'mpg', 'rmvb', 'ts', 'vob', 'VOB', 'webm', 'wmv', 'm2ts'],
    'image': ['bmp', 'gif', 'jfif', 'jpeg', 'jpg', 'JPG', 'png', 'ico', 'webp'],
    'text': ['log', 'nfo', 'txt'],
    'text-html': ['html', 'mhtml', 'css'],
    'lossy': ['m4a', 'mp3', 'opus', 'wma', 'Mp3'],
    'lossless': ['flac'],
    'lossless-alt': ['wav', 'ape', 'ogg'],
    'application-pdf': ['pdf'],
    'application-javascript': ['js'],
    'application-x-7z-compressed': ['7z', 'zip', 'rar'],
    'application-x-shockwave-flash': ['swf'],
}

# Keep as false to keep file size low
JSON_OUTPUT = {
    'keep_raw_date': False,
    'keep_raw_size': False
}

JS_SCRIPT = """ZnVuY3Rpb24gJChlKXt2YXIgdD0ic3RyaW5nIj09dHlwZW9mIGU/ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZSk6ZTtyZXR1cm4gdC5vbj1mdW5jdGlvbihlLG8peyJjb250ZW50IGxvYWRlZCI9PWUmJihlPXdpbmRvdy5hdHRhY2hFdmVudD8ibG9hZCI6IkRPTUNvbnRlbnRMb2FkZWQiKSx0LmFkZEV2ZW50TGlzdGVuZXI/dC5hZGRFdmVudExpc3RlbmVyKGUsbywhMSk6dC5hdHRhY2hFdmVudCgib24iK2Usbyl9LHQuYWxsPWZ1bmN0aW9uKGUpe3JldHVybiAkKHQucXVlcnlTZWxlY3RvckFsbChlKSl9LHQuZWFjaD1mdW5jdGlvbihlKXtmb3IodmFyIG89MCxyPXQubGVuZ3RoO288cjsrK28pZSgkKHRbb10pLG8pfSx0LmdldENsYXNzZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRBdHRyaWJ1dGUoImNsYXNzIikuc3BsaXQoL1xzKy8pfSx0LmFkZENsYXNzPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXMuZ2V0QXR0cmlidXRlKCJjbGFzcyIpO3Quc2V0QXR0cmlidXRlKCJjbGFzcyIsbz9vKyIgIitlOmUpfSx0LnJlbW92ZUNsYXNzPWZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuZ2V0Q2xhc3NlcygpLmZpbHRlcigoZnVuY3Rpb24odCl7cmV0dXJuIHQhPWV9KSk7dGhpcy5zZXRBdHRyaWJ1dGUoImNsYXNzIix0LmpvaW4oIiAiKSl9LHR9ZnVuY3Rpb24gc2VhcmNoKCl7dmFyIGU9JCgic2VhcmNoIikudmFsdWUudG9Mb3dlckNhc2UoKTskKCJmaWxlcyIpLmFsbCgiYSIpLmVhY2goKGZ1bmN0aW9uKHQpe3ZhciBvPXQudGV4dENvbnRlbnQudG9Mb3dlckNhc2UoKTsiLi4iIT1vJiYoZS5sZW5ndGgmJn5vLmluZGV4T2YoZSk/dC5hZGRDbGFzcygiaGlnaGxpZ2h0Iik6dC5yZW1vdmVDbGFzcygiaGlnaGxpZ2h0IikpfSkpfSQod2luZG93KS5vbigiY29udGVudCBsb2FkZWQiLChmdW5jdGlvbigpeyQoInNlYXJjaCIpLm9uKCJrZXl1cCIsc2VhcmNoKX0pKTtjb25zdCBDT05GSUc9e2JhdGNoU2l6ZToyNSxuYXZpZ2F0aW9uRGVsYXk6MjAwLHVzZUZvcm1hdHRlZERhdGU6ITAsdXNlRm9ybWF0dGVkU2l6ZTohMCxhbGw6Ij4qICIsZm9sZGVyOiI+KmZvbGRlciAiLGZpbGU6Ij4qZmlsZSAiLG1lbW9yeUNhY2hlOiEwfTtmdW5jdGlvbiBoYXNDb2Fyc2VQb2ludGVyKCl7cmV0dXJuIHdpbmRvdy5tYXRjaE1lZGlhKCIocG9pbnRlcjogY29hcnNlKSIpLm1hdGNoZXN9Y29uc3QgbWVtb3J5Q2FjaGU9bmV3IE1hcDtmdW5jdGlvbiBnZXRFbWJlZGRlZEpTT04oKXtjb25zdCBlPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJkb20tY2FjaGUiKTtpZihlJiZlLnRleHRDb250ZW50KXRyeXtyZXR1cm4gSlNPTi5wYXJzZShlLnRleHRDb250ZW50KX1jYXRjaChlKXtyZXR1cm4gY29uc29sZS5lcnJvcigiRXJyb3IgcGFyc2luZyBlbWJlZGRlZCBKU09OOiIsZSksbnVsbH1yZXR1cm4gbnVsbH1DT05GSUcubWVtb3J5Q2FjaGV8fChtZW1vcnlDYWNoZS5nZXQ9KCk9Pnt9LG1lbW9yeUNhY2hlLnNldD0oKT0+e30pO2xldCBpbml0aWFsTG9hZENvbXBsZXRlPSExLHVzaW5nTWVtb3J5Q2FjaGU9ITE7YXN5bmMgZnVuY3Rpb24gcHJlbG9hZERpcmVjdG9yeURhdGEoKXt0cnl7Y29uc3QgZT1nZXRFbWJlZGRlZEpTT04oKTtpZighZSl0aHJvdyBuZXcgRXJyb3IoIk5vIGVtYmVkZGVkIEpTT04gZGF0YSBmb3VuZCIpO3JldHVybiBDT05GSUcubWVtb3J5Q2FjaGUmJm1lbW9yeUNhY2hlLnNldCgiZGlyZWN0b3J5RGF0YSIsZSksaW5pdGlhbExvYWRDb21wbGV0ZT0hMCxlfWNhdGNoKGUpe3Rocm93IGNvbnNvbGUuZXJyb3IoIkVycm9yIGxvYWRpbmcgZW1iZWRkZWQgSlNPTiBkYXRhOiIsZSksaW5pdGlhbExvYWRDb21wbGV0ZT0hMCxlfX1hc3luYyBmdW5jdGlvbiBmZXRjaERpcmVjdG9yeURhdGEoKXtpZighaW5pdGlhbExvYWRDb21wbGV0ZSl0cnl7cmV0dXJuIGF3YWl0IHByZWxvYWREaXJlY3RvcnlEYXRhKCl9Y2F0Y2goZSl7dGhyb3cgY29uc29sZS5lcnJvcigiRmFpbGVkIHRvIHByZWxvYWQgZGlyZWN0b3J5IGRhdGE6IixlKSxlfWlmKENPTkZJRy5tZW1vcnlDYWNoZSl7Y29uc3QgZT1tZW1vcnlDYWNoZS5nZXQoImRpcmVjdG9yeURhdGEiKTtpZihlKXJldHVybiBlfWNvbnN0IGU9Z2V0RW1iZWRkZWRKU09OKCk7aWYoZSlyZXR1cm4gQ09ORklHLm1lbW9yeUNhY2hlJiZtZW1vcnlDYWNoZS5zZXQoImRpcmVjdG9yeURhdGEiLGUpLGU7dGhyb3cgbmV3IEVycm9yKCJVbmFibGUgdG8gcmV0cmlldmUgZGlyZWN0b3J5IGRhdGEiKX1kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJET01Db250ZW50TG9hZGVkIiwoZnVuY3Rpb24oKXt3aW5kb3cuaXNGb2xkZXJOYXZpZ2F0aW9uPSExLHByZWxvYWREaXJlY3RvcnlEYXRhKCkudGhlbigoKCk9PmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUluaXRpYWxIYXNoKCl7aWYod2luZG93LmxvY2F0aW9uLmhhc2gpe2NvbnN0IGU9d2luZG93LmxvY2F0aW9uLmhhc2guc3Vic3RyaW5nKDEpO3RyeXtjb25zdCB0PWF3YWl0IGZpbmRQYXRoQnlEaXJlY3RvcnlJZChlKTtpZih0KXt1PVtdO3JldHVybiBidWlsZFBhdGhIaXN0b3J5KHQsYXdhaXQgZmV0Y2hEaXJlY3RvcnlEYXRhKCksdSksbG9nUGF0aEhpc3RvcnkoIiMiLCEwKSxSSVBFKHQpfX1jYXRjaChlKXtjb25zb2xlLmVycm9yKCJFcnJvciBoYW5kbGluZyBpbml0aWFsIGhhc2g6IixlKX19cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpfSgpKSkuY2F0Y2goKGU9Pntjb25zb2xlLmVycm9yKCJGYWlsZWQgdG8gaW5pdGlhbGl6ZSBkaXJlY3RvcnkgZGF0YToiLGUpfSkpO2NvbnN0IGU9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInNlYXJjaCIpO2Z1bmN0aW9uIHVwZGF0ZVNlYXJjaERhdGFsaXN0KCl7aGFzQ29hcnNlUG9pbnRlcigpP2Uuc2V0QXR0cmlidXRlKCJsaXN0Iiwic2VhcmNoLXBhdHRlcm5zIik6ZS5yZW1vdmVBdHRyaWJ1dGUoImxpc3QiKX1lLmFkZEV2ZW50TGlzdGVuZXIoImtleWRvd24iLChmdW5jdGlvbihlKXsiRW50ZXIiPT09ZS5rZXkmJnRoaXMuYmx1cigpfSkpLHVwZGF0ZVNlYXJjaERhdGFsaXN0KCk7Y29uc3QgdD13aW5kb3cubWF0Y2hNZWRpYSgiKHBvaW50ZXI6IGNvYXJzZSkiKTt0LmFkZEV2ZW50TGlzdGVuZXI/dC5hZGRFdmVudExpc3RlbmVyKCJjaGFuZ2UiLHVwZGF0ZVNlYXJjaERhdGFsaXN0KTp0LmFkZExpc3RlbmVyKHVwZGF0ZVNlYXJjaERhdGFsaXN0KTtsZXQgbz0hMTtlLmFkZEV2ZW50TGlzdGVuZXIoImlucHV0IiwoZnVuY3Rpb24oZSl7Y29uc3QgdD10aGlzLnZhbHVlLnN0YXJ0c1dpdGgoQ09ORklHLmFsbCkscj10aGlzLnZhbHVlLnN0YXJ0c1dpdGgoQ09ORklHLmZvbGRlciksbj10aGlzLnZhbHVlLnN0YXJ0c1dpdGgoQ09ORklHLmZpbGUpLGE9dHx8cnx8bjtpZihvJiZhJiYoeT0hMCksIW8mJmEmJihvPSEwLHJlc2V0VG9Sb290KCkpLGEmJm8pe2xldCBlLHQ7cj8oZT10aGlzLnZhbHVlLnN1YnN0cmluZyg5KS50cmltKCksdD0iZm9sZGVyIik6bj8oZT10aGlzLnZhbHVlLnN1YnN0cmluZyg3KS50cmltKCksdD0iZmlsZSIpOihlPXRoaXMudmFsdWUuc3Vic3RyaW5nKDMpLnRyaW0oKSx0PSJhbGwiKSxlP2Z1bmN0aW9uIHBlcmZvcm1TcGVjaWFsU2VhcmNoKGUsdD0iYWxsIil7aWYoIi4uIj09PWUpcmV0dXJuO2NvbnN0IG89KyttO2lmKCJyb290IiE9PWgpcmV0dXJuIHZvaWQgZnVuY3Rpb24gZmlsdGVyQ3VycmVudFZpZXcoZSx0PSJhbGwiKXtpZigiLi4iPT09ZSlyZXR1cm47Y29uc3Qgbz1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKCJbZGF0YS1wYXRoXSIpLnF1ZXJ5U2VsZWN0b3JBbGwoImxpIikscj1lLnRvTG93ZXJDYXNlKCksbj1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIuZGlyZWN0b3J5LXBhdGgiKSxhPW4uaW5uZXJIVE1MO2lmKCFhLmluY2x1ZGVzKCc8YSBocmVmPSIjc2VhcmNoIj5TZWFyY2ggUmVzdWx0czwvYT4nKSl7Y29uc3QgZT1hLmxhc3RJbmRleE9mKCIvIik7aWYoLTEhPT1lKXtjb25zdCB0PWEuc3Vic3RyaW5nKDAsZSkrJyAvIDxhIGhyZWY9IiNzZWFyY2giPlNlYXJjaCBSZXN1bHRzPC9hPicrYS5zdWJzdHJpbmcoZSk7bi5pbm5lckhUTUw9dH19by5mb3JFYWNoKChlPT57Y29uc3Qgbz1lLnF1ZXJ5U2VsZWN0b3IoIi5uYW1lIik7aWYobyl7Y29uc3Qgbj1lLnF1ZXJ5U2VsZWN0b3IoImEiKS5jbGFzc0xpc3QuY29udGFpbnMoImljb24tZGlyZWN0b3J5Iik7aWYoImZvbGRlciI9PT10JiYhbilyZXR1cm4gdm9pZChlLnN0eWxlLmRpc3BsYXk9Im5vbmUiKTtpZigiZmlsZSI9PT10JiZuKXJldHVybiB2b2lkKGUuc3R5bGUuZGlzcGxheT0ibm9uZSIpO2NvbnN0IGE9by50ZXh0Q29udGVudC50b0xvd2VyQ2FzZSgpLGk9YT09PXJ8fHIubGVuZ3RoPj0zJiZuZXcgUmVnRXhwKGBcXGIke2VzY2FwZVJlZ0V4cChyKX1cXGJgLCJpIikudGVzdChhKTtlLnN0eWxlLmRpc3BsYXk9aT8iIjoibm9uZSJ9fSkpfShlLHQpO3JldHVybiBmZXRjaERpcmVjdG9yeURhdGEoKS50aGVuKChyPT57aWYobyE9PW0pcmV0dXJuO2NvbnN0IG49W10sYT1lLnRvTG93ZXJDYXNlKCksaT1yLmRpcmVjdG9yaWVzfHx7fTtmb3IoY29uc3QgZSBpbiBpKXtpZihvIT09bSlyZXR1cm47aVtlXS5maWx0ZXIoKGU9PntpZigiZm9sZGVyIj09PXQmJiJkaXJlY3RvcnkiIT09ZS50eXBlKXJldHVybiExO2lmKCJmaWxlIj09PXQmJiJkaXJlY3RvcnkiPT09ZS50eXBlKXJldHVybiExO2NvbnN0IG89ZS5uYW1lLnRvTG93ZXJDYXNlKCk7cmV0dXJuIG89PT1hfHxhLmxlbmd0aD49MyYmbmV3IFJlZ0V4cChgXFxiJHtlc2NhcGVSZWdFeHAoYSl9XFxiYCwiaSIpLnRlc3Qobyl9KSkuZm9yRWFjaCgodD0+e3QucGFyZW50RGlyPWUsbi5wdXNoKHQpfSkpfWlmKG8hPT1tKXJldHVybjtyZXR1cm4gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLmRpcmVjdG9yeS1wYXRoIikuaW5uZXJIVE1MPSc8YSBocmVmPSIvIj5+PC9hPiAvIDxhIGhyZWY9IiNzZWFyY2giPlNlYXJjaCBSZXN1bHRzPC9hPiAvICcsZnVuY3Rpb24gZGlzcGxheU1hdGNoaW5nSXRlbXMoZSx0KXtjb25zdCBvPWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIltkYXRhLXBhdGhdIik7aWYoIW8pcmV0dXJuO3k9ITEsby5pbm5lckhUTUw9IiI7Y29uc3Qgcj17fTtlLmZvckVhY2goKGU9PntyW2UucGFyZW50RGlyXXx8KHJbZS5wYXJlbnREaXJdPVtdKSxyW2UucGFyZW50RGlyXS5wdXNoKGUpfSkpO2NvbnN0IG49W107Zm9yKGNvbnN0IGUgaW4gcil7Y29uc3QgdD0icm9vdCI9PT1lPyJSb290IERpcmVjdG9yeSI6ZS5yZXBsYWNlKC9cXC9nLCIgLyAiKS5yZXBsYWNlKC9cLy9nLCI8c3Bhbj4gLyA8L3NwYW4+Iik7bi5wdXNoKHtpc0hlYWRlcjohMCxkaXJQYXRoOmUsY29udGVudDp0fSkscltlXS5mb3JFYWNoKChlPT57bi5wdXNoKHtpc0hlYWRlcjohMSxpdGVtOmV9KX0pKX1sZXQgYT0wO2Z1bmN0aW9uIHByb2Nlc3NOZXh0QmF0Y2goKXtpZih5fHx0IT09bSlyZXR1cm47aWYoYT49bi5sZW5ndGgpcmV0dXJuO2NvbnN0IGU9blthXTtpZihlLmlzSGVhZGVyKXtjb25zdCB0PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImxpIik7dC5jbGFzc05hbWU9ImRpcmVjdG9yeS1oZWFkZXIiLHQuaW5uZXJIVE1MPSIuIj09PWUuY29udGVudD8ifiA8c3Bhbj4gLyA8L3NwYW4+IjpgfiA8c3Bhbj4gLyA8L3NwYW4+JHtlLmNvbnRlbnR9YCxvLmFwcGVuZENoaWxkKHQpfWVsc2V7Y29uc3QgdD1lLml0ZW0scj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJsaSIpO3IuaW5uZXJIVE1MPWBcbiAgICAgICAgICAgICAgICAgICAgICAgIDxhIGhyZWY9IiR7ImRpcmVjdG9yeSI9PT10LnR5cGU/dC5wYXRoOnQucGFyZW50RGlyfSIgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzcz0iJHsiZGlyZWN0b3J5Ij09PXQudHlwZT8iaWNvbiBpY29uLWRpcmVjdG9yeSI6dC5pY29uX2NsYXNzZXN9IiBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPSIke3QubmFtZX0iPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9Im5hbWUiPiR7dC5uYW1lfTwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJkYXRlIj4ke0NPTkZJRy51c2VGb3JtYXR0ZWREYXRlP3QuZGF0ZV9mb3JtYXR0ZWQ6dC5kYXRlfTwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJzaXplIj4ke0NPTkZJRy51c2VGb3JtYXR0ZWRTaXplP3Quc2l6ZV9mb3JtYXR0ZWQ6dC5zaXplfTwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvYT5cbiAgICAgICAgICAgICAgICAgICAgYCxvLmFwcGVuZENoaWxkKHIpfXJldHVybiBhKysscmVxdWVzdEFuaW1hdGlvbkZyYW1lKHByb2Nlc3NOZXh0QmF0Y2gpfXJldHVybiBwcm9jZXNzTmV4dEJhdGNoKCl9KG4sbyl9KSl9KGUsdCk6ZnVuY3Rpb24gcmVzZXRUb05vcm1hbERpc3BsYXkoKXtpZigicm9vdCI9PT1oKXtjb25zdCBlPWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIltkYXRhLXBhdGhdIik7ZS5pbm5lckhUTUw9ZCxhcHBseVRvZ2dsZUNsYXNzZXMoZSksc2VhcmNoKCl9ZWxzZSBSSVBFKGgpfSgpfWVsc2UhYSYmbyYmKG89ITEseT0hMCxyZXNldFRvUm9vdCghMCkpO3Nlc3Npb25TdG9yYWdlLnNldEl0ZW0oInNlYXJjaFRleHQiLHRoaXMudmFsdWUpfSkpO2NvbnN0IHI9c2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgic2VhcmNoVGV4dCIpO3ImJihyLnN0YXJ0c1dpdGgoQ09ORklHLmFsbCl8fHIuc3RhcnRzV2l0aChDT05GSUcuZm9sZGVyKXx8ci5zdGFydHNXaXRoKENPTkZJRy5maWxlKT8oc2Vzc2lvblN0b3JhZ2UucmVtb3ZlSXRlbSgic2VhcmNoVGV4dCIpLGUudmFsdWU9IiIpOihlLnZhbHVlPXIsc2VhcmNoKCkpKTtjb25zdCBuPWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIiNmaWxlcyIpLGE9ZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLmRhdGUtdG9nZ2xlIiksaT1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIuc2l6ZS10b2dnbGUiKSxzPSJ0cnVlIj09PXNlc3Npb25TdG9yYWdlLmdldEl0ZW0oInNob3dEYXRlIiksYz0idHJ1ZSI9PT1zZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCJzaG93U2l6ZSIpO2Z1bmN0aW9uIGRpc2FibGVTbGlkZXJUcmFuc2l0aW9uKGUpe2NvbnN0IHQ9ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgIyR7ZX1gKTt0LnN0eWxlLnRyYW5zaXRpb249IjBzIjtjb25zdCBvPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInN0eWxlIik7by50ZXh0Q29udGVudD1gIyR7ZX06OmJlZm9yZSB7IHRyYW5zaXRpb246IDBzIH1gLGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQobyksc2V0VGltZW91dCgoKCk9Pnt0LnN0eWxlLnJlbW92ZVByb3BlcnR5KCJ0cmFuc2l0aW9uIiksZG9jdW1lbnQuaGVhZC5yZW1vdmVDaGlsZChvKX0pLDUwKX1mdW5jdGlvbiBhcHBseVRvZ2dsZUNsYXNzZXMoZSl7Y29uc3QgdD0idHJ1ZSI9PT1zZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCJzaG93RGF0ZSIpLG89InRydWUiPT09c2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgic2hvd1NpemUiKTt0JiZlLmNsYXNzTGlzdC5hZGQoInNob3ctZGF0ZSIpLG8mJmUuY2xhc3NMaXN0LmFkZCgic2hvdy1zaXplIil9YS5jaGVja2VkPXMsaS5jaGVja2VkPWMscz8oZGlzYWJsZVNsaWRlclRyYW5zaXRpb24oInNsaWRlci1kYXRlIiksbi5jbGFzc0xpc3QuYWRkKCJzaG93LWRhdGUiKSk6bi5jbGFzc0xpc3QucmVtb3ZlKCJzaG93LWRhdGUiKSxjPyhkaXNhYmxlU2xpZGVyVHJhbnNpdGlvbigic2xpZGVyLXNpemUiKSxuLmNsYXNzTGlzdC5hZGQoInNob3ctc2l6ZSIpKTpuLmNsYXNzTGlzdC5yZW1vdmUoInNob3ctc2l6ZSIpLGEuYWRkRXZlbnRMaXN0ZW5lcigiY2hhbmdlIiwoZnVuY3Rpb24oKXtuLmNsYXNzTGlzdC50b2dnbGUoInNob3ctZGF0ZSIsdGhpcy5jaGVja2VkKSxzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKCJzaG93RGF0ZSIsdGhpcy5jaGVja2VkKX0pKSxpLmFkZEV2ZW50TGlzdGVuZXIoImNoYW5nZSIsKGZ1bmN0aW9uKCl7bi5jbGFzc0xpc3QudG9nZ2xlKCJzaG93LXNpemUiLHRoaXMuY2hlY2tlZCksc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbSgic2hvd1NpemUiLHRoaXMuY2hlY2tlZCl9KSk7Y29uc3QgbD1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1wYXRoPSJyb290Il0nKSxkPWwuaW5uZXJIVE1MO2xldCBoPSJyb290Iix1PVtdO2FwcGx5VG9nZ2xlQ2xhc3NlcyhsKTtsZXQgZj0hMTtmdW5jdGlvbiBSSVBFKGUpe3JldHVybiB5PSEwLG5ldyBQcm9taXNlKCgodCxvKT0+e2ZldGNoRGlyZWN0b3J5RGF0YSgpLnRoZW4oKHI9Pntjb25zdCBuPXIuZGlyZWN0b3JpZXNbZV07aWYobil7Y29uc3Qgcj1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKCJbZGF0YS1wYXRoXSIpO2lmKCFyKXJldHVybiBjb25zb2xlLmVycm9yKCJDb250YWluZXIgbm90IGZvdW5kIGZvciBwYXRoOiIsaCksdm9pZCBvKCJDb250YWluZXIgbm90IGZvdW5kIik7ci5zZXRBdHRyaWJ1dGUoImRhdGEtcGF0aCIsZSksYXBwbHlUb2dnbGVDbGFzc2VzKHIpLGg9ZTtjb25zdCBhPWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi5kaXJlY3RvcnktcGF0aCIpO2xldCBpPSc8YSBocmVmPSIvIj5+PC9hPiAvICc7dS5mb3JFYWNoKChlPT57Y29uc3QgdD1lLnNwbGl0KC9bXC9cXF0vKS5wb3AoKTtpKz1gPGEgaHJlZj0iJHtlfSI+JHt0fTwvYT4gLyBgfSkpLGEuaW5uZXJIVE1MPWksci5pbm5lckhUTUw9IiIseT0hMSxhc3luYyBmdW5jdGlvbiBwcm9jZXNzQmF0Y2goZSx0LG8pe2lmKHkpcmV0dXJuO2NvbnN0IHI9ZS5zbGljZSh0LHQrQ09ORklHLmJhdGNoU2l6ZSk7aWYoMD09PXIubGVuZ3RoKXJldHVybjtjb25zdCBuPXIubWFwKChlPT5gXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsaT48YSBocmVmPSIkeyJkaXJlY3RvcnkiPT09ZS50eXBlP2UucGF0aDpofSIgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzcz0iJHsiZGlyZWN0b3J5Ij09PWUudHlwZT8iaWNvbiBpY29uLWRpcmVjdG9yeSI6ZS5pY29uX2NsYXNzZXN9IiBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPSIke2UubmFtZX0iPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9Im5hbWUiPiR7ZS5uYW1lfTwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJkYXRlIj4ke0NPTkZJRy51c2VGb3JtYXR0ZWREYXRlP2UuZGF0ZV9mb3JtYXR0ZWQ6ZS5kYXRlfTwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJzaXplIj4ke0NPTkZJRy51c2VGb3JtYXR0ZWRTaXplP2Uuc2l6ZV9mb3JtYXR0ZWQ6ZS5zaXplfTwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9hPjwvbGk+YCkpLmpvaW4oIiIpO3JldHVybiBvLmluc2VydEFkamFjZW50SFRNTCgiYmVmb3JlZW5kIixuKSxuZXcgUHJvbWlzZSgocj0+e3JlcXVlc3RBbmltYXRpb25GcmFtZSgoKCk9PntyKHByb2Nlc3NCYXRjaChlLHQrQ09ORklHLmJhdGNoU2l6ZSxvKSl9KSl9KSl9KG4sMCxyKS50aGVuKCgoKT0+e3NlYXJjaCgpLHQoKX0pKX1lbHNlIG8oIkRpcmVjdG9yeSBjb250ZW50cyBub3QgZm91bmQiKX0pKX0pKX1kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsKGZ1bmN0aW9uKGUpe2NvbnN0IHQ9ZS50YXJnZXQuY2xvc2VzdCgiYSIpO2lmKCF0KXJldHVybjsodC5jbG9zZXN0KCIuZGlyZWN0b3J5LXBhdGgiKXx8dC5jbG9zZXN0KCIjZmlsZXMiKSkmJmUucHJldmVudERlZmF1bHQoKTtjb25zdCBvPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJzZWFyY2giKSxyPW8mJm8udmFsdWUuc3RhcnRzV2l0aChDT05GSUcuYWxsKSxuPW8mJm8udmFsdWUuc3RhcnRzV2l0aChDT05GSUcuZm9sZGVyKSxhPW8mJm8udmFsdWUuc3RhcnRzV2l0aChDT05GSUcuZmlsZSksaT1yfHxufHxhO2lmKHk9ITAsdC5jbGFzc0xpc3QuY29udGFpbnMoImljb24tZGlyZWN0b3J5Iil8fHQuY2xvc2VzdCgiLmRpcmVjdG9yeS1wYXRoIikpe2lmKGYpcmV0dXJuO2NvbnN0IGU9dC5nZXRBdHRyaWJ1dGUoImhyZWYiKSxvPWhhc0NvYXJzZVBvaW50ZXIoKT9DT05GSUcubmF2aWdhdGlvbkRlbGF5OjA7aWYoIiNzZWFyY2giPT09ZSlyZXR1cm47aSYmcmVzZXRTZWFyY2hTdGF0ZSgpLGhhc0NvYXJzZVBvaW50ZXIoKSYmKGY9ITAsc2V0VGltZW91dCgoKCk9PntmPSExfSksQ09ORklHLm5hdmlnYXRpb25EZWxheSkpLHNldFRpbWVvdXQoKCgpPT57aWYoIi8iIT09dC5nZXRBdHRyaWJ1dGUoImhyZWYiKSl7aWYoIi4uIj09PWUpcmV0dXJuIHUubGVuZ3RoPjAmJih1LnBvcCgpLGxvZ1BhdGhIaXN0b3J5KCI8IikpLDA9PT11Lmxlbmd0aD92b2lkIHJlc2V0VG9Sb290KCEwKTood2luZG93LmlzRm9sZGVyTmF2aWdhdGlvbj0hMCx2b2lkIFJJUEUodVt1Lmxlbmd0aC0xXSkpO2lmKHQuY2xvc2VzdCgiLmRpcmVjdG9yeS1wYXRoIikpe2NvbnN0IGU9QXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIuZGlyZWN0b3J5LXBhdGgiKS5nZXRFbGVtZW50c0J5VGFnTmFtZSgiYSIpKS5pbmRleE9mKHQpOy0xIT09ZSYmKHU9dS5zbGljZSgwLGUpLGxvZ1BhdGhIaXN0b3J5KCLwn42eIikpfWVsc2UgaT9mZXRjaERpcmVjdG9yeURhdGEoKS50aGVuKCh0PT57dT1bXSxidWlsZFBhdGhIaXN0b3J5KGUsdCx1KSxsb2dQYXRoSGlzdG9yeSgiPiIpLHdpbmRvdy5pc0ZvbGRlck5hdmlnYXRpb249ITAsUklQRShlKX0pKTowIT09dS5sZW5ndGgmJnVbdS5sZW5ndGgtMV09PT1lfHwodS5wdXNoKGUpLGxvZ1BhdGhIaXN0b3J5KCI+IikpO3dpbmRvdy5pc0ZvbGRlck5hdmlnYXRpb249ITAsUklQRShlKX1lbHNlIHJlc2V0VG9Sb290KCEwLCEwKX0pLG8pfWVsc2V7Y29uc3QgZT1oYXNDb2Fyc2VQb2ludGVyKCk/Q09ORklHLm5hdmlnYXRpb25EZWxheTowO2hhc0NvYXJzZVBvaW50ZXIoKSYmKGY9ITAsc2V0VGltZW91dCgoKCk9PntmPSExfSksQ09ORklHLm5hdmlnYXRpb25EZWxheSkpLHNldFRpbWVvdXQoKCgpPT57aWYoaSYmdC5jbG9zZXN0KCJsaSIpJiYhdC5jbGFzc0xpc3QuY29udGFpbnMoImljb24tZGlyZWN0b3J5Iikpe2NvbnN0IGU9dC5nZXRBdHRyaWJ1dGUoImhyZWYiKSxvPXQuZ2V0QXR0cmlidXRlKCJ0aXRsZSIpO2lmKCIuIj09PWUpcmV0dXJuIGxhc3RDbGlja2VkSXRlbU5hbWU9dC5nZXRBdHRyaWJ1dGUoInRpdGxlIikscmVzZXRTZWFyY2hTdGF0ZSgpLHZvaWQgcmVzZXRUb1Jvb3QoITEsITEsITEsITApO2ZldGNoRGlyZWN0b3J5RGF0YSgpLnRoZW4oKHQ9Pnt1PVtdLGJ1aWxkUGF0aEhpc3RvcnkoZSx0LHUpLGxvZ1BhdGhIaXN0b3J5KCI+Iik7Y29uc3Qgcj1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIuZGlyZWN0b3J5LXBhdGgiKTtsZXQgbj0nPGEgaHJlZj0iLyI+fjwvYT4gLyAnO3UuZm9yRWFjaCgoZT0+e2NvbnN0IHQ9ZS5zcGxpdCgvW1wvXFxdLykucG9wKCk7bis9YDxhIGhyZWY9IiR7ZX0iPiR7dH08L2E+IC8gYH0pKSxyLmlubmVySFRNTD1uLHJlc2V0U2VhcmNoU3RhdGUoKSx3aW5kb3cuaXNGb2xkZXJOYXZpZ2F0aW9uPSEwLFJJUEUoZSkudGhlbigoKCk9PntoaWdobGlnaHRBbmRTY3JvbGxUb0l0ZW0oIltkYXRhLXBhdGhdIixvKX0pKX0pKX1lbHNlInJvb3QiPT09aD9yZXNldFRvUm9vdCghMCk6KGxvZ1BhdGhIaXN0b3J5KCItIiksd2luZG93LmlzRm9sZGVyTmF2aWdhdGlvbj0hMCxSSVBFKGgpKX0pLGUpfX0pKTtsZXQgbT0wO2Z1bmN0aW9uIGVzY2FwZVJlZ0V4cChlKXtyZXR1cm4gZS5yZXBsYWNlKC9bLiorP14ke30oKXxbXF1cXF0vZywiXFwkJiIpfWxldCB5PSExO2Z1bmN0aW9uIHJlc2V0VG9Sb290KGU9ITEsdD0hMSxvPSExLHI9ITEpe3dpbmRvdy5sb2NhdGlvbi5oYXNoJiZoaXN0b3J5LnB1c2hTdGF0ZSgiIixkb2N1bWVudC50aXRsZSx3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUrd2luZG93LmxvY2F0aW9uLnNlYXJjaCksdT1bXSx5PSEwO2NvbnN0IG49ZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiW2RhdGEtcGF0aF0iKTtuLmlubmVySFRNTD1kLG4uc2V0QXR0cmlidXRlKCJkYXRhLXBhdGgiLCJyb290IiksZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLmRpcmVjdG9yeS1wYXRoIikuaW5uZXJIVE1MPSc8YSBocmVmPSIvIj5+PC9hPiAvICcsaD0icm9vdCIsYXBwbHlUb2dnbGVDbGFzc2VzKG4pLGxvZ1BhdGhIaXN0b3J5KHQ/IvCfjZ4iOm8/IiMiOiItIiksZSYmc2VhcmNoKCksciYmbGFzdENsaWNrZWRJdGVtTmFtZSYmaGlnaGxpZ2h0QW5kU2Nyb2xsVG9JdGVtKCJbZGF0YS1wYXRoXSIsbGFzdENsaWNrZWRJdGVtTmFtZSwibGFzdENsaWNrZWRJdGVtTmFtZSIpfWZ1bmN0aW9uIGJ1aWxkUGF0aEhpc3RvcnkoZSx0LG8pe2NvbnN0IHI9ZS5zcGxpdCgvW1wvXFxdLyk7bGV0IG49IiI7ci5mb3JFYWNoKChyPT57aWYoIiIhPT1yLnRyaW0oKSl7aWYoIiI9PT1uKW49cjtlbHNle2NvbnN0IHQ9ZS5pbmNsdWRlcygiLyIpPyIvIjoiXFwiO24rPXQrcn10LmRpcmVjdG9yaWVzJiZ0LmRpcmVjdG9yaWVzW25dJiYhby5pbmNsdWRlcyhuKSYmby5wdXNoKG4pfX0pKX1mdW5jdGlvbiByZXNldFNlYXJjaFN0YXRlKCl7ZS52YWx1ZT0iIixzZXNzaW9uU3RvcmFnZS5yZW1vdmVJdGVtKCJzZWFyY2hUZXh0Iiksbz0hMX1mdW5jdGlvbiBoaWdobGlnaHRBbmRTY3JvbGxUb0l0ZW0oZSx0LG89bnVsbCl7Y29uc3Qgcj1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKGUpO3ImJnNldFRpbWVvdXQoKCgpPT57ci5xdWVyeVNlbGVjdG9yQWxsKCJsaSBhIikuZm9yRWFjaCgoZT0+e2UuZ2V0QXR0cmlidXRlKCJ0aXRsZSIpPT09dCYmKGUuY2xhc3NMaXN0LmFkZCgiaGlnaGxpZ2h0IiksZS5zY3JvbGxJbnRvVmlldyh7YmVoYXZpb3I6InNtb290aCIsYmxvY2s6ImNlbnRlciJ9KSl9KSksbnVsbCE9PW8mJih3aW5kb3dbb109bnVsbCl9KSwxMDApfWZ1bmN0aW9uIGxvZ1BhdGhIaXN0b3J5KGUsdD0hMSl7Y29uc29sZS5jbGVhcigpO2NvbnN0IG89ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInNlYXJjaCIpO3JldHVybiBvJiYoby52YWx1ZS5zdGFydHNXaXRoKENPTkZJRy5hbGwpfHxvLnZhbHVlLnN0YXJ0c1dpdGgoQ09ORklHLmZvbGRlcil8fG8udmFsdWUuc3RhcnRzV2l0aChDT05GSUcuZmlsZSkpJiZjb25zb2xlLmxvZygiJWNSZWdFeCBkZXRlY3RlZCwgaW4gc3BlY2lhbCBzZWFyY2ggbW9kZSIsImZvbnQtc3R5bGU6IGl0YWxpYyIpLG8mJihvLnZhbHVlLnN0YXJ0c1dpdGgoQ09ORklHLmFsbCl8fG8udmFsdWUuc3RhcnRzV2l0aChDT05GSUcuZm9sZGVyKXx8by52YWx1ZS5zdGFydHNXaXRoKENPTkZJRy5maWxlKSl8fChjb25zb2xlLmdyb3VwKGBbJHtlfV0gQ3VycmVudCBwYXRoYCksY29uc29sZS5sb2coIn4gLyIpKSx1Lmxlbmd0aD4wP2ZldGNoRGlyZWN0b3J5RGF0YSgpLnRoZW4oKGU9PntsZXQgbz0iIjt1LmZvckVhY2goKCh0LHIpPT57Y29uc3Qgbj10LnNwbGl0KC9bXC9cXF0vKS5wb3AoKSxhPXQuc3BsaXQoL1tcL1xcXS8pO2xldCBpPSIiLHM9bnVsbDtmb3IobGV0IHQ9MDt0PGEubGVuZ3RoO3QrKylpZigwPT09dClpPWFbMF0scz1lLmRpcmVjdG9yaWVzWyIuIl0/LmZpbmQoKGU9PmUucGF0aD09PWkpKTtlbHNle2k9YS5zbGljZSgwLHQrMSkuam9pbigiXFwiKTtjb25zdCBvPWEuc2xpY2UoMCx0KS5qb2luKCJcXCIpO3M9KGUuZGlyZWN0b3JpZXNbb118fFtdKS5maW5kKChlPT5lLnBhdGg9PT1pKSl9Y29uc3QgYz1zPy5kaXJlY3RvcnlfaWR8fCJ1bmtub3duIjtjb25zb2xlLmxvZyhgJHtufSB7IyR7Y319IC8gYCkscj09PXUubGVuZ3RoLTEmJihvPWMpfSkpLGNvbnNvbGUuZ3JvdXBFbmQoKSx0fHxmdW5jdGlvbiBhcHBlbmRVUkxIYXNoKGUpe2lmKGUmJiJ1bmtub3duIiE9PWUpe2xldCB0PXdpbmRvdy5sb2NhdGlvbi5ocmVmLnNwbGl0KCIjIilbMF07d2luZG93LmxvY2F0aW9uLmhyZWY9YCR7dH0jJHtlfWB9ZWxzZSBoaXN0b3J5LnB1c2hTdGF0ZSgiIixkb2N1bWVudC50aXRsZSx3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUrd2luZG93LmxvY2F0aW9uLnNlYXJjaCl9KG8pfSkpOihjb25zb2xlLmdyb3VwRW5kKCksUHJvbWlzZS5yZXNvbHZlKCkpfWFzeW5jIGZ1bmN0aW9uIGZpbmRQYXRoQnlEaXJlY3RvcnlJZChlKXtyZXR1cm4gZnVuY3Rpb24gc2VhcmNoRGlyZWN0b3JpZXMoZSx0KXtmb3IoY29uc3RbbyxyXW9mIE9iamVjdC5lbnRyaWVzKGUpKWlmKCIuIiE9PW8pe2Zvcihjb25zdCBlIG9mIHIpaWYoZS5kaXJlY3RvcnlfaWQ9PT10KXJldHVybiBlLnBhdGh9ZWxzZSBmb3IoY29uc3QgZSBvZiByKWlmKGUuZGlyZWN0b3J5X2lkPT09dClyZXR1cm4gZS5wYXRoO3JldHVybiBudWxsfSgoYXdhaXQgZmV0Y2hEaXJlY3RvcnlEYXRhKCkpLmRpcmVjdG9yaWVzLGUpfXdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJoYXNoY2hhbmdlIiwoZnVuY3Rpb24gaGFuZGxlSGFzaENoYW5nZSgpe2lmKHdpbmRvdy5pc0ZvbGRlck5hdmlnYXRpb24pcmV0dXJuIHZvaWQod2luZG93LmlzRm9sZGVyTmF2aWdhdGlvbj0hMSk7Y29uc3QgZT13aW5kb3cubG9jYXRpb24uaGFzaDtpZihlKXtyZXR1cm4gZmluZFBhdGhCeURpcmVjdG9yeUlkKGUuc3Vic3RyaW5nKDEpKS50aGVuKChlPT57aWYoZSlyZXR1cm4gdT1bXSxmZXRjaERpcmVjdG9yeURhdGEoKS50aGVuKCh0PT4oYnVpbGRQYXRoSGlzdG9yeShlLHQsdSksbG9nUGF0aEhpc3RvcnkoIiMiLCEwKS50aGVuKCgoKT0+UklQRShlKSkpKSkpLmNhdGNoKChlPT57Y29uc29sZS5lcnJvcigiRXJyb3IgYnVpbGRpbmcgcGF0aCBoaXN0b3J5OiIsZSl9KSl9KSkuY2F0Y2goKGU9Pntjb25zb2xlLmVycm9yKCJFcnJvciBoYW5kbGluZyBoYXNoIGNoYW5nZToiLGUpfSkpfXJldHVybiByZXNldFRvUm9vdCghMCwhMSwhMCl9KSksbG9nUGF0aEhpc3RvcnkoIi0iKX0pKTs="""

CSS_STYLE = """.directory h1,.header{margin-bottom:15px}#files span,label{display:inline-block}a,body{color:#555}#search,*{outline:0}*{margin:0;padding:0}body{padding:80px 100px;font:13px "Helvetica Neue","Lucida Grande",Arial;background:-webkit-gradient(linear,0 0,0 100%,from(#fff),to(#ece9e9)) #ece9e9;background:-moz-linear-gradient(top,#fff,#ece9e9) #ece9e9;background-repeat:no-repeat;-webkit-font-smoothing:antialiased}h1,h2,h3{font-size:22px;color:#343434}h1 em,h2 em{padding:0 5px;font-weight:400}h1{font-size:60px}h2{margin-top:10px}h3{margin:5px 0 10px;padding-bottom:5px;border-bottom:1px solid #eee;font-size:18px}ul li{list-style:none}ul li:hover{cursor:pointer;color:#2e2e2e}ul li .path{padding-left:5px;font-weight:700}ul li .line{padding-right:5px;font-style:italic}ul li:first-child .path{padding-left:0}p{line-height:1.5}.info a:hover,a{text-decoration:none}a:hover{color:#303030}#stacktrace{margin-top:15px}.directory h1{font-size:18px}ul#files{width:100%;height:100%;overflow:hidden}ul#files li{float:left;width:30%;line-height:25px;margin:1px}ul#files li a{display:block;height:25px;border:1px solid transparent;-webkit-border-radius:5px;-moz-border-radius:5px;border-radius:5px;overflow:hidden;white-space:nowrap}ul#files li a:focus,ul#files li a:hover{background:rgba(255,255,255,.65);border:1px solid #ececec}ul#files li a.highlight{-webkit-transition:background .4s ease-in-out;transition:background .4s ease-in-out;background:#ffff4f;border-color:#e9dc51}#search{display:block;position:fixed;top:20px;right:20px;width:90px;-webkit-transition:width .2s,opacity .4s;-moz-transition:width .2s,opacity .4s;transition:width .2s,opacity .4s;-webkit-border-radius:32px;-moz-border-radius:32px;border-radius:32px;-webkit-box-shadow:inset 0 0 3px rgba(0,0,0,.25),inset 0 1px 3px rgba(0,0,0,.7),0 1px 0 rgba(255,255,255,.03);-moz-box-shadow:inset 0 0 3px rgba(0,0,0,.25),inset 0 1px 3px rgba(0,0,0,.7),0 1px 0 rgba(255,255,255,.03);box-shadow:inset 0 0 3px rgba(0,0,0,.25),inset 0 1px 3px rgba(0,0,0,.7),0 1px 0 rgba(255,255,255,.03);-webkit-font-smoothing:antialiased;text-align:left;font:13px "Helvetica Neue",Arial,sans-serif;padding:4px 10px;border:none;background:0 0;margin-bottom:0;opacity:.7;color:#888}.slider,.slider:before{position:absolute;transition:.2s}#search:focus{width:120px;opacity:1}#files span{overflow:hidden;text-overflow:ellipsis;text-indent:10px}#files .name{background-repeat:no-repeat;image-rendering:pixelated}#files .icon .name{text-indent:28px}.view-tiles .name{width:100%;background-position:8px 5px}.view-tiles .date,.view-tiles .size{display:none}ul#files.view-details li{float:none;display:block;width:90%}ul#files.view-details li.header{height:25px;background:#000;color:#fff;font-weight:700}.view-details .header{border-radius:5px}.view-details .name{width:60%;background-position:8px 5px}.view-details .size{width:10%}.view-details .date{width:30%}.view-details .date,.view-details .size{text-align:right;direction:rtl}#files .icon-directory .name{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABGdBTUEAALGPC/xhBQAAAWtQTFRFAAAA/PPQ9Nhc2q402qQ12qs2/PTX2pg12p81+/LM89NE9dto2q82+/fp2rM22qY39d6U+/bo2qo2/frx/vz32q812qs12qE279SU8c4w9NZP+/LK//367s9y7s925cp0/vzw9t92//342po2/vz25s1579B6+OSO2bQ0/v799NyT8tE79dld8Msm+OrC/vzx79KA2IYs7s6I9d6R4cJe9+OF/PLI/fry79OF/v30//328tWB89RJ8c9p8c0u9eCf//7+9txs6sts5Mdr+++5+u2z/vrv+/fq6cFz8dBs8tA57cpq+OaU9uGs27Y8//799NdX/PbY9uB89unJ//z14sNf+emh+emk+vDc+uys9+OL8dJy89NH+eic8tN5+OaV+OWR9N2n9dtl9t529+KF9+GB9Nue9NdU8tR/9t5y89qW9dpj89iO89eG/vvu2pQ12Y4z/vzy2Ict/vvv48dr/vzz4sNg///+2Igty3PqwQAAAAF0Uk5TAEDm2GYAAACtSURBVBjTY2AgA2iYlJWVhfohBPg0yx38y92dS0pKVOVBAqIi6sb2vsWWpfrFeTI8QAEhYQEta28nCwM1OVleZqCAmKCEkUdwYWmhQnFeOStQgL9cySqkNNDHVJGbiY0FKCCuYuYSGRsV5KgjxcXIARRQNncNj09JTgqw0ZbkZAcK5LuFJaRmZqfHeNnpSucDBQoiEtOycnIz4qI9bfUKQA6pKKqAgqIKQyK8BgAZ5yfODmnHrQAAAABJRU5ErkJggg==)}#files .icon-application-x-7z-compressed .name,#files .icon-rar .name{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAG9SURBVDjLpZO9apRREIafDVuIhMjGhPwJukashNjoNdgIqQQbG8U7ECy0i4UXIMQLEKxtrCwsRMRKbBSCoBhQwRjwZ3e/M/O+FufbTYRYZWA45wznnXk4Z6Zjm8PYFIe0LsDDG/1pm03jy5gpAzbIxga3q2wMv2Q/uPXo8wZAZ/P6qVmbrd7iyd7cUh86HWhFMvvcpKBE4fv2B358+7Rx+/H23a7Nq+PL/d7c8ipf3r+kjH6jhDSkTAjCRoISZmbhNDMLq4S4c+/K8rmu8fzahYu8fvaEwc+dKm5FIZMJIVMSIsXu1ltmhw1nzq6x8/XjeteG+ZVF1q/dRKMhVqBInElG4igoApXxPlEJpo4t8eaF6drgEIPdd6j5g0KoqCYpSRShkq0LlZps+ugJZOjWxxEuSQ6zVohETZIh1LTiNqYQGTVmtwQqiUZBjgKVICfVsj0Ll7GwpYvcI1AkOSyUYTkQN4twCjWB0jgryYTAjYhRkIPyH1zVilETOV19QlCSHAQ5bA7GTaEUDuFxZ9EmsCGLOLJyvv5AGmvvstVWlGt/7zNjOvevrjy1uST90+8Hz4HBVYkrwfPOYcf5L9lR/9+EMK8xAAAAAElFTkSuQmCC)}#files .icon-default .name{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC4SURBVCjPdZFbDsIgEEWnrsMm7oGGfZrohxvU+Iq1TyjU60Bf1pac4Yc5YS4ZAtGWBMk/drQBOVwJlZrWYkLhsB8UV9K0BUrPGy9cWbng2CtEEUmLGppPjRwpbixUKHBiZRS0p+ZGhvs4irNEvWD8heHpbsyDXznPhYFOyTjJc13olIqzZCHBouE0FRMUjA+s1gTjaRgVFpqRwC8mfoXPPEVPS7LbRaJL2y7bOifRCTEli3U7BMWgLzKlW/CuebZPAAAAAElFTkSuQmCC)}#files .icon-video .name{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAIfSURBVDjLpZNPaBNBGMXfbrubzBqbg4kL0lJLgiVKE/AP6Kl6UUFQNAeDIAjVS08aELx59GQPAREV/4BeiqcqROpRD4pUNCJSS21OgloISWMEZ/aPb6ARdNeTCz92mO+9N9/w7RphGOJ/nsH+olqtvg+CYJR8q9VquThxuVz+oJTKeZ63Uq/XC38E0Jj3ff8+OVupVGLbolkzQw5HOqAxQU4wXWWnZrykmYD0QsgAOJe9hpEUcPr8i0GaJ8n2vs/sL2h8R66TpVfWTdETHWE6GRGKjGiiKNLii5BSLpN7pBHpgMYhMkm8tPUWz3sL2D1wFaY/jvnWcTTaE5DyjMfTT5J0XIAiTRYn3ASwZ1MKbTmN7z+KaHUOYqmb1fcPiNa4kQBuyvWAHYfcHGzDgYcx9NKrwJYHCAyF21JiPWBnXMAQOea6bmn+4ueYGZi8gtymNVobF7BG5prNpjd+eW6X4BSUD0gOdCpzA8MpA/v2v15kl4+pK0emwHSbjJGBlz+vYM1fQeDrYOBTdzOGvDf6EFNr+LYjHbBgsaCLxr+moNQjU2vYhRXpgIUOmSWWnsJRfjlOZhrexgtYDZ/gWbetNRbNs6QT10GJglNk64HMaGgbAkoMo5fiFNy7CKDQUGqE5r38YktxAfSqW7Zt33l66WtkAkACjuNsaLVaDxlw5HdJ/86aYrG4WCgUZD6fX+jv/U0ymfxoWVZomuZyf+8XqfGP49CCrBUAAAAASUVORK5CYII=)}#files .icon-bat .name{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAGNSURBVDjLpVM9SwNBEJ297J1FQBtzjQj2dgppYiP4A1KZRoiFrYWt9rHyH6QUPBDTCimtLNSAnSB26YKg4EdMdsd5611cjwsIWRhmZ3f2zZuPVcxMsyx9fPF0NRfS2vM7lx2WtcQiJHvDRvZMluXMGNHstJH7+Wj09jHkOy1+tc3VxeC+P6TXT1sYZX2hT7cvS6lepv3zHUp2T8vXNw81dXT2yGwEGeERSbSVCC5qysYa+3vm9sJGmLFojceXJ9uklCqUIAic5G3IytahAAhqqVSiwWDwx6nogW9XKhWphaGAvC50Oh1qtVr/7oAdCwBQwjB00mg0qFqtUr1ed3YURZM7X7TWTqM2Gm3CASRJEur1etTtdp1DnrafFtJGMbVNGSBas9l0DrAzR6x8DdwASUB0RqNNGS2/gH7EInvCwMhkZTnlnX0GsP09tJER0BgMoAEAa1rETDIQvBkjBZeHMIjjuNB5Ggg0/oZWPGrHGwd7Fp9F2CAlgHKqf0aYXb6Y2mzE8d/IfrXVrN/5G81p6oa2mIEUAAAAAElFTkSuQmCC)}#files .icon-image .name{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAGWSURBVBgZpcE/a1NhGMbh3/OeN56cKq2Dp6AoCOKmk4uCn8DNycEOIojilr2TaBfRzVnESQR3Bz+FFDoWA2IjtkRqmpyc97k9qYl/IQV7XSaJw4g0VlZfP0m13dwepPbuiH85fyhyWCx4/ubxjU6kkdxWHt69VC6XpZlFBAhwJgwJJHAmRKorbj94ewvoRBrbuykvT5R2/+lLTp05Tp45STmEJYJBMAjByILxYeM9jzr3GCczGpHGYAQhRM6fO8uFy1fJQoaUwCKYEcwwC4QQaGUBd36KTDmQ523axTGQmEcIEBORKQfG1ZDxcA/MkBxXwj1ggCQyS9TVAMmZiUxJ8Ln/kS+9PmOvcSW+jrao0mmMH5bzHfa+9UGBmciUBJ+2Fmh1h+yTQCXSkJkdCrpd8btIwwEJQnaEkOXMk7XaiF8CUxL/JdKQOwb0Ntc5SG9zHXQNd/ZFGsaEeLa2ChjzXQcqZiKNxSL0vR4unVwwMENMCATib0ZdV+QtE41I42geXt1Ze3dlMNZFdw6Ut6CIvKBhkjiM79Pyq1YUmtkKAAAAAElFTkSuQmCC)}#files .icon-db .name{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAHVSURBVDjLjZPLaiJBFIZNHmJWCeQdMuT1Mi/gYlARBRUkao+abHUhmhgU0QHtARVxJ0bxhvfGa07Of5Iu21yYFPyLrqrz1f+f6rIRkQ3icca6ZF39RxesU1VnAVyuVqvJdrvd73Y7+ky8Tk6n87cVYgVcoXixWNByuVSaTqc0Ho+p1+sJpNvtksvlUhCb3W7/cf/w+BSLxfapVIqSySRlMhnSdZ2GwyHN53OaTCbU7/cFYBgG4RCPx/MKub27+1ur1Xqj0YjW6zWxCyloNBqUSCSkYDab0WAw+BBJeqLFtQpvGoFqAlAEaZomuc0ocAQnnU7nALiJ3uh8whgnttttarVaVCgUpCAUCgnQhMAJ+gG3CsDZa7xh1mw2ZbFSqYgwgsGgbDQhcIWeAHSIoP1pcGeNarUqgFKpJMLw+/0q72azkYhmPAWIRmM6AGbXc7kc5fN5AXi9XgWACwAguLEAojrfsVGv1yV/sVikcrksAIfDIYUQHEAoPgLwT3GdzWYNdBfXh3xwApDP5zsqtkoBwuHwaSAQ+OV2u//F43GKRCLEc5ROpwVoOngvBXj7jU/wwZPPX72DT7RXgDfIT27QEgvfKea9c3m9FsA5IN94zqbw9M9fAEuW+zzj8uLvAAAAAElFTkSuQmCC)}#files .icon-docx .name{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAIdSURBVDjLjZO7a5RREMV/9/F9yaLBzQY3CC7EpBGxU2O0EBG0sxHBUitTWYitYCsiiJL0NvlfgoWSRpGA4IMsm43ZXchmv8e9MxZZN1GD5MCBW8yce4aZY1QVAGPMaWAacPwfm8A3VRUAVJWhyIUsy7plWcYQgh7GLMt0aWnpNTADWFX9Q2C+LMu4s7Oj/X5/xF6vp51OR1utloYQtNls6vLy8kjE3Huz9qPIQjcUg/GZenVOokIEiSBBCKUSQ+TFwwa1Wo2iKBARVlZW3iwuLr7izssPnwZ50DLIoWz9zPT+s/fabrf/GQmY97GIIXGWp28/08si5+oV1jcGTCSO6nHH2pddYqmkaUq320VECCFQr9cBsBIVBbJcSdXQmK7Q6Qsnq54sj2gBplS896RpSpIkjI2NjVZitdh7jAOSK6trXcpC2GjlfP1esHD+GDYozjm893jvSZJkXyAWe+ssc6W5G9naLqkaw/pGxBrl1tVpJCrWWpxzI6GRgOQKCv2BYHPl5uUatROeSsVy7eIkU9UUiYoxBgDnHNbagw4U6yAWwpmphNvXT6HAhAZuLNRx1iDDWzHG/L6ZEbyJVLa2c54/PgsKgyzw5MHcqKC9nROK/aaDvwN4KYS7j959DHk2PtuYnBUBFUEVVBQRgzX7I/wNM7RmgEshhFXAcDSI9/6KHQZKAYkxDgA5SnOMcReI5kCcG8M42yM6iMDmL261eaOOnqrOAAAAAElFTkSuQmCC)}#files .icon-exe .name{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAE8SURBVDjLpVM9SwNREJzTpx4JaGMn/oJrRMtU/g2xsLD1F/gDbK0lpaAgNmJnI1YWasBOELs0QgQDfsQ4Mxb3vEvgipwuLAsLszszb19iG/+JsHf6dDU3g9WXdzdtABIsAQZowjJkwSRkwyQoYX52+PYx8F0w0FrPFqfuuwP0P1W5ZW2hi9vXpViXsXOyieOtw+b1zUMr2T16tGnYBizYhqR8a2QjquxRkAjJsIhgGhsrg4q9CYDpmGWMerZ//oxgC1mW/clAnl0gIE6UqvXbLlIqJTYaDeibCBRrAX97ACAKwXIt4KgHEhEUGdQBlgOE4Khd0sTAMQZkzoDkxMBiAI1g5gzSNK39jJYQJKHT6SBN00KGpDFGVfJ6vR5kIyQetg8uh9tiH+IIMNb8hPOzNV2cuATAX+3kv9/5B7T5iPkmloFJAAAAAElFTkSuQmCC)}#files .icon-py .name,#files .icon-text-html .name{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAHtSURBVDjLjZM9T9tQFIYpQ5eOMBKlW6eWIQipa8RfQKQghEAKqZgKFQgmFn5AWyVDCipVQZC2EqBWlEqdO2RCpAssQBRsx1+1ndix8wFvfW6wcUhQsfTI0j33PD7n+N4uAF2E+/S5RFwG/8Njl24/LyCIOI6j1+v1y0ajgU64cSSTybdBSVAwSMmmacKyLB/DMKBpGkRRZBJBEJBKpXyJl/yABLTBtm1Uq1X2JsrlMnRdhyRJTFCpVEAfSafTTUlQoFs1luxBAkoolUqQZbmtJTYTT/AoHInOfpcwtVtkwcSBgrkDGYph+60oisIq4Xm+VfB0+U/P0Lvj3NwPGfHPTcHMvoyFXwpe7UmQtAqTUCU0D1VVbwTPVk5jY19Fe3ZfQny7CE51WJDXqpjeEUHr45ki9rIqa4dmQiJfMLItGEs/FcQ2ucbRmdnSYy5vYWyLx/w3EaMfLmBaDpMQvuDJ65PY8Dpnz3wpYmLtApzcrIAqmfrEgdZH1grY/a36w6Xz0DKD8ES25/niYS6+wWE8mWfByY8cXmYEJFYLkHUHtVqNQcltAvoLD3v7o/FUHsNvzlnwxfsCEukC/ho3yUHaBN5Buo17Ojtyl+DqrnvQgUtfcC0ZcAdkUeA+ye7eMru9AUGIJPe4zh509UP/AAfNypi8oj/mAAAAAElFTkSuQmCC)}#files .icon-ini .name{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAEkSURBVCjPbdE9S0IBGIbhxxobWxP8D8r5I60RLg0NNTS21VBRQwg1aA4VOAWBpBVCFhKUtkVJtPQx9GFFWh49x3P0bvAjjsWzXrzvcAtpREEZfQtoACEkpKBVdpouv7NYi3SJkAynWcXExKTCJ6+4PLPeIZJPhksdmzp1vilTwqVGlWhEgR6wsbGpU+OLt94rGfJ1gIOLi4OFSYV3Sjx5QXdtkiHFx//gjiwlTshyT5LV3T8gwy3HFLnhkCuWmB3qA0Uu2WGOZVIUmN/ru5CiwAsLNLCI8cg+i3hAggMeiNOgwQbXRJnwghoX5DkiTow0OcLJ8HAbtLpkkzwJCuTY4pQppgeFFLJNtxMrzSRFtlnhvDXO6Fk7ll8hb+wZxpChoPzoB6aiXIYcSLDWAAAAAElFTkSuQmCC)}#files .icon-application-javascript .name{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAHdSURBVDjLjZNPaxNBGIdrLwURLznWgkcvIrQhRw9FGgy01IY0TVsQ0q6GFkT0kwjJId9AP4AHP4Q9FO2hJ7El2+yf7OzMbja7Sf0578QdNybFLjwszLu/Z2femZkDMEfI54FkRVL4Dw8l8zqXEawMBgM2HA6vR6MRZiHraDabH7KSrKBA4SAIEIahxvd9eJ6HbrerJKZpotVqaUkavkMC+iCKIsRxrN6EEAKMMViWpQT9fh/0k3a7PZZkBUPmqXAKCSjAOYdt21NLUj1JBYW7C6vi6BC8vKWKQXUXQcNA5Nh6KY7jqJl0Op1JwY/Hi7mLp/lT/uoA/OX2WLC3C9FoQBwfILKulIRmQv1wXfevwHmyuMPXS5Fv1MHrFSTmhSomnUvw/Spo3C+vg3/+pJZDPSGRFvilNV+8PUZvoziKvn+d3LZvJ/BelMDevIZXK2EQCiUhtMDM53bY5rOIGXtwjU3EVz/HM5Az8eplqPFKEfzLR91cOg8TPTgr3MudFx+d9owK7KMNVfQOtyQ1OO9qiHsWkiRRUHhKQLuwfH9+1XpfhVVfU0V3//k4zFwdzjIlSA/Sv8jTOZObBL9uugczuNaCP5K8bFBIhduE5bdC3d6MYIkkt7jOKXT1l34DkIu9e0agZjoAAAAASUVORK5CYII=)}#files .icon-text .name{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAADoSURBVBgZBcExblNBGAbA2ceegTRBuIKOgiihSZNTcC5LUHAihNJR0kGKCDcYJY6D3/77MdOinTvzAgCw8ysThIvn/VojIyMjIyPP+bS1sUQIV2s95pBDDvmbP/mdkft83tpYguZq5Jh/OeaYh+yzy8hTHvNlaxNNczm+la9OTlar1UdA/+C2A4trRCnD3jS8BB1obq2Gk6GU6QbQAS4BUaYSQAf4bhhKKTFdAzrAOwAxEUAH+KEM01SY3gM6wBsEAQB0gJ+maZoC3gI6iPYaAIBJsiRmHU0AALOeFC3aK2cWAACUXe7+AwO0lc9eTHYTAAAAAElFTkSuQmCC)}#files .icon-application-pdf .name{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAHhSURBVDjLjZPLSxtRFIfVZRdWi0oFBf+BrhRx5dKVYKG4tLhRqlgXPmIVJQiC60JCCZYqFHQh7rrQlUK7aVUUfCBRG5RkJpNkkswrM5NEf73n6gxpHujAB/fOvefjnHM5VQCqCPa1MNoZnU/Qxqhx4woE7ZZlpXO53F0+n0c52Dl8Pt/nQkmhoJOCdUWBsvQJ2u4ODMOAwvapVAqSJHGJKIrw+/2uxAmuJgFdMDUVincSxvEBTNOEpmlIp9OIxWJckMlkoOs6AoHAg6RYYNs2kp4RqOvfuIACVFVFPB4vKYn3pFjAykDSOwVta52vqW6nlEQiwTMRBKGygIh9GEDCMwZH6EgoE+qHLMuVBdbfKwjv3yE6Ogjz/PQ/CZVDPSFRRYE4/RHy1y8wry8RGWGSqyC/nM1meX9IQpQV2JKIUH8vrEgYmeAFwuPDCHa9QehtD26HBhCZnYC8ucGzKSsIL8wgsjiH1PYPxL+vQvm5B/3sBMLyIm7GhhCe90BaWykV/Gp+VR9oqPVe9vfBTsruM1HtBKVPmFIUNusBrV3B4ev6bsbyXlPdkbr/u+StHUkxruBPY+0KY8f38oWX/byvNAdluHNLeOxDB+uyQQfPCWZ3NT69BYJWkjxjnB1o9Fv/ASQ5s+ABz8i2AAAAAElFTkSuQmCC)}#files .icon-application-x-shockwave-flash .name{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAHYSURBVDjLjZPLSxtRFMa1f0UXCl0VN66igg80kQZtsLiUWhe14MKFIFHbIEF8BNFFKYVkkT9GKFJooXTToq2gLkQT82oyjzuvO8nXe65mmIkRHfg2c+/3O+d8l9MBoIMkvi6hkNDAA3om9MTz+QAhy7JqnPO667poJ3GOdDr92Q/xAwbIrOs6GGOeFEVBtVpFoVCQkHw+j0wm40Ga5k4C0AXTNGHbNsxv32Hu7YNtp1Cr1VAsFiXAMAxQkWw2ewNpBZDZPjiA+XYebioJ9nIKqqqiVCrdGUlm0gpwzs5hzrwGX1uGMTMLtvrBG6VcLstOcrncPQDOYW3tgCffw0isg4uqnP6J8AhCnVAelUqlPYD/PYE59wZ67BXsL4fg/6ryYhNC82uaJkFtAdbHT+CJFbgbCagjYbDNlDev4zgyH4KQ7gA2n/fMUWWeiAtzBMrgWABAXciAhaibAKAYnXyaGx3/5cSXoIajsH/8hHP8B87llTSSqAMSmQMAfSL2VYtET5WRCLcW3oHt7Aaq+s1+eQAt/EJXh8MNe2kRSmwa/LoQeOsmpFUeQB0ag9I/jIve0G/n6Lhx3x60Ud3L4DbIPhEQo4PHmMVdTW6vD9BNkEesc1O0+t3/AXamvvzW7S+UAAAAAElFTkSuQmCC)}#files .icon-lossy .name{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA7HpUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHjajVHbDcMwCPz3FB0BA34wjvOSukHH7yXGSVOpUol8hjOBMw7r67mFx25cOWgqNVvOBFNT4wanUrfpwEh6oAc0nBsfzgMGJdilh8bOr+DhR4/Nm8SRPwqdnRq8dB205vx05ycvyPW7kCuQ2DvT4j94IWFXpD2eXVG2Wm5XW2a6W72WSuGcciwKVKZSssGvTFowz2UXus1sR6HUB3oSIx6pDE28ShQCimhXKftK0rDLgRaQGPE10ASM0gdPeEpIgHLzRo3OYX7O5prRD/vnWuENE3B2paV6HGcAAAGEaUNDUElDQyBwcm9maWxlAAB4nH2RPUjDQBzFX1OlKhUHO4g4RKgOYhcVcSxVLIKF0lZo1cHk0i9o0pCkuDgKrgUHPxarDi7Oujq4CoLgB4i74KToIiX+Lym0iPHguB/v7j3u3gFCo8JUsysKqJplpOIxMZtbFQOv8KMXAiYwKjFTT6QXM/AcX/fw8fUuwrO8z/05+pW8yQCfSBxlumERbxDPblo6533iECtJCvE58aRBFyR+5Lrs8hvnosMCzwwZmdQ8cYhYLHaw3MGsZKjEM8RhRdUoX8i6rHDe4qxWaqx1T/7CYF5bSXOd5gjiWEICSYiQUUMZFViI0KqRYiJF+zEP/7DjT5JLJlcZjBwLqEKF5PjB/+B3t2ZhespNCsaA7hfb/hgDArtAs27b38e23TwB/M/Aldb2VxvA3Cfp9bYWPgIGtoGL67Ym7wGXO8DQky4ZkiP5aQqFAvB+Rt+UAwZvgb41t7fWPk4fgAx1tXwDHBwC40XKXvd4d09nb/+eafX3A55icri5sbxFAAANdmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNC40LjAtRXhpdjIiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iCiAgICB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIgogICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIgogICAgeG1sbnM6R0lNUD0iaHR0cDovL3d3dy5naW1wLm9yZy94bXAvIgogICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iCiAgIHhtcE1NOkRvY3VtZW50SUQ9ImdpbXA6ZG9jaWQ6Z2ltcDowNTdiY2VjNy1hMDkxLTQwMWQtODU2OC04YTFiYmZkODAwYjMiCiAgIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MTNmM2FjM2ItN2E4MS00MTc0LWEzY2ItOTM4NzhlYzFhMGQ2IgogICB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6ZmRmODIwMzctNjU4OS00Mjg4LTljMzYtZTYzZmNjOGQ0ZDM2IgogICBkYzpGb3JtYXQ9ImltYWdlL3BuZyIKICAgR0lNUDpBUEk9IjIuMCIKICAgR0lNUDpQbGF0Zm9ybT0iV2luZG93cyIKICAgR0lNUDpUaW1lU3RhbXA9IjE3NDE0OTIyMTA3NzM1NDQiCiAgIEdJTVA6VmVyc2lvbj0iMi4xMC4zNCIKICAgdGlmZjpPcmllbnRhdGlvbj0iMSIKICAgeG1wOkNyZWF0b3JUb29sPSJHSU1QIDIuMTAiCiAgIHhtcDpNZXRhZGF0YURhdGU9IjIwMjU6MDM6MDlUMTE6NTA6MTArMDg6MDAiCiAgIHhtcDpNb2RpZnlEYXRlPSIyMDI1OjAzOjA5VDExOjUwOjEwKzA4OjAwIj4KICAgPHhtcE1NOkhpc3Rvcnk+CiAgICA8cmRmOlNlcT4KICAgICA8cmRmOmxpCiAgICAgIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiCiAgICAgIHN0RXZ0OmNoYW5nZWQ9Ii8iCiAgICAgIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6YzM1MjI2ZDAtNWMzZi00NmE2LWE3YTUtY2NiN2ZkZjcyZjQ3IgogICAgICBzdEV2dDpzb2Z0d2FyZUFnZW50PSJHaW1wIDIuMTAgKFdpbmRvd3MpIgogICAgICBzdEV2dDp3aGVuPSIyMDI1LTAzLTA5VDExOjUwOjEwIi8+CiAgICA8L3JkZjpTZXE+CiAgIDwveG1wTU06SGlzdG9yeT4KICA8L3JkZjpEZXNjcmlwdGlvbj4KIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0IGVuZD0idyI/PusUzmgAAAAGYktHRAD8AKIANfjISw4AAAAJcEhZcwAALiMAAC4jAXilP3YAAAAHdElNRQfpAwkDMgrI1NaGAAAAGXRFWHRDb21tZW50AENyZWF0ZWQgd2l0aCBHSU1QV4EOFwAAAXZJREFUOMuVk81q21AQhb+597aIbow3fhgtWohbmln4MbppoQTSLtNFIZv+0AfxvloEtzu/ivGi2AY5KNaVpwtVSlSpKRk4CO4wZ37OkVDHmap+4z+RZdkH4Ctw3UmoquV5bodDaTHGQRRFYapqwAXwpEdwOJSW57nt9/sWu93ONpuNrddrizHaarXqkbg/wDnBe08IAedcCxFBRAAYjUbM53NU9SNwDiCA+35yWp0+e4oslr29bZry6/UrxuNx5302m5FlmQ8AaWHIYolNU+zFSVOKXP1EFksen71hu91yPB6JMTKZTFqicJf1+vwtSZJ0OsliSQgBEaGqKrz3nXy4X7h6d+99ewszewhBHc0xB3P39r/6UX/ldhLnuiVum76sRuFRn/nyU6uKmQ2OD+CGiouiGJS08UbnbRfLusvseatAkiTYNG190Bzwrqk6JKr6z39gCGUZG0vjgGMz9sCKfWca3NwUfwkN71T1Mw+ILMveA19+A4dl4YAIh3q1AAAAAElFTkSuQmCC)}#files .icon-lossless .name{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA7npUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHjajVHbjcQwCPx3FVcCBvygHOclXQdb/k5snFxWWumIPIYxgTEO++v3CD+nceWgqdRsORNMTY0bnErDlo6RtKMHNJ0HH64DBiXYZYTGzu/g4UePzZvEmT8LXZ0avHQftOb88uQXL8j1s5ArkDg60+Y/eCFhV6QjXl1RtloeV9tWelq9l0rhnHIsClSmUrLBr0xaMM/tFHqsbL1QGgO9iBnPVIYm3iUKAUV0qJRzJWnYpaMFJEZ8TVQqkMX64AlPCQlQbt6o0TXMv7O5Z/TF/nOt8AYbX3a2P/ZGYwAAAYRpQ0NQSUNDIHByb2ZpbGUAAHicfZE9SMNAHMVfU6UqFQc7iDhEqA5iFxVxLFUsgoXSVmjVweTSL2jSkKS4OAquBQc/FqsOLs66OrgKguAHiLvgpOgiJf4vKbSI8eC4H+/uPe7eAUKjwlSzKwqommWk4jExm1sVA6/woxcCJjAqMVNPpBcz8Bxf9/Dx9S7Cs7zP/Tn6lbzJAJ9IHGW6YRFvEM9uWjrnfeIQK0kK8TnxpEEXJH7kuuzyG+eiwwLPDBmZ1DxxiFgsdrDcwaxkqMQzxGFF1ShfyLqscN7irFZqrHVP/sJgXltJc53mCOJYQgJJiJBRQxkVWIjQqpFiIkX7MQ//sONPkksmVxmMHAuoQoXk+MH/4He3ZmF6yk0KxoDuF9v+GAMCu0Czbtvfx7bdPAH8z8CV1vZXG8DcJ+n1thY+Aga2gYvrtibvAZc7wNCTLhmSI/lpCoUC8H5G35QDBm+BvjW3t9Y+Th+ADHW1fAMcHALjRcpe93h3T2dv/55p9fcDnmJyuLmxvEUAAA5VaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/Pgo8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA0LjQuMC1FeGl2MiI+CiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiCiAgICB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iCiAgICB4bWxuczpHSU1QPSJodHRwOi8vd3d3LmdpbXAub3JnL3htcC8iCiAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIKICAgeG1wTU06RG9jdW1lbnRJRD0iZ2ltcDpkb2NpZDpnaW1wOmU1ZGE4ZmRhLTc2MWUtNDZmMS1iZjBmLTk0MTZhMTQ2ZGM4YyIKICAgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoyM2RkMDgyNi1lNzZkLTQzMTAtOTE0ZS1hNzkzOWM3YTQ0OTAiCiAgIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpkMGUyOTZhZS1hZjVlLTQ4MDMtOTJiYy1hZTM0YzZlOGU3ODAiCiAgIGRjOkZvcm1hdD0iaW1hZ2UvcG5nIgogICBHSU1QOkFQST0iMi4wIgogICBHSU1QOlBsYXRmb3JtPSJXaW5kb3dzIgogICBHSU1QOlRpbWVTdGFtcD0iMTc0MTQ5MjEwOTc4MzQ3NCIKICAgR0lNUDpWZXJzaW9uPSIyLjEwLjM0IgogICB0aWZmOk9yaWVudGF0aW9uPSIxIgogICB4bXA6Q3JlYXRvclRvb2w9IkdJTVAgMi4xMCIKICAgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyNTowMzowOVQxMTo0ODoyOSswODowMCIKICAgeG1wOk1vZGlmeURhdGU9IjIwMjU6MDM6MDlUMTE6NDg6MjkrMDg6MDAiPgogICA8eG1wTU06SGlzdG9yeT4KICAgIDxyZGY6U2VxPgogICAgIDxyZGY6bGkKICAgICAgc3RFdnQ6YWN0aW9uPSJzYXZlZCIKICAgICAgc3RFdnQ6Y2hhbmdlZD0iLyIKICAgICAgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDoyY2YzMjdlMi1lNzM1LTQxNjgtYTkzMS1kYWMyYzc1N2ZmNWYiCiAgICAgIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkdpbXAgMi4xMCAoV2luZG93cykiCiAgICAgIHN0RXZ0OndoZW49IjIwMjUtMDMtMDlUMTE6NDE6MTIiLz4KICAgICA8cmRmOmxpCiAgICAgIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiCiAgICAgIHN0RXZ0OmNoYW5nZWQ9Ii8iCiAgICAgIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6ODAyOTRkNGMtOTBkYi00M2E1LWE5NDEtNGM4NTgxYWVjMzAwIgogICAgICBzdEV2dDpzb2Z0d2FyZUFnZW50PSJHaW1wIDIuMTAgKFdpbmRvd3MpIgogICAgICBzdEV2dDp3aGVuPSIyMDI1LTAzLTA5VDExOjQ4OjI5Ii8+CiAgICA8L3JkZjpTZXE+CiAgIDwveG1wTU06SGlzdG9yeT4KICA8L3JkZjpEZXNjcmlwdGlvbj4KIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0IGVuZD0idyI/PpPkvsAAAAAGYktHRAD8AKIANfjISw4AAAAJcEhZcwAALiMAAC4jAXilP3YAAAAHdElNRQfpAwkDMB15MTHDAAAAGXRFWHRDb21tZW50AENyZWF0ZWQgd2l0aCBHSU1QV4EOFwAAAZhJREFUOMuVk7+LE0EUxz9vdrK7KP4ojiBccUVqK8HiihQpco7F4b9wnaXgXWth64n/hvgHuNimsE1lJSlO5EBMwBBz7G4mMxbJDrtkifpginnz3pfPvO+MsIkXxph3/CWyLHsFvAVuqpwAGGP8+9MrkiRxIqLamu8+/8JgMNgRCcVJkriiKFRRFFRruVyyWCyYzWZYaxmPxxhjXgMvgVuVQAdARFQURWitUUqFJSKICADz+ZzRaFQXQYDOx8GT8uTIoSbxDrrrlfx8+JXDi2+N/HA4JMuyWAMc5x41iXG9Ev9gtanwID86qElM/Cjm+vII5xzWWrrdLs8+bMp0XfX34++kaRr2KrmDmsRorRER1us1URQ1SPQ+27ZXJ4qiMAvv/b8LBJLtMFvP9hJcJVsSCSRKNVvUr+OT8p7u7DTr0UFwxXvfig+g2przPG+1tHobjdzcroLflQNpmuJ6ZchXA6w/qiBw//MneXp7je1PG3y2P6U8u8b2p20Cblu2UjVsqR3sC5fnuWr8RuDcGPOG/4gsyy6Ayz9vx5IkaqHqAwAAAABJRU5ErkJggg==)}#files .icon-lossless-alt .name{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA7npUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHjajVHbjcQwCPx3FVcCBvygHOclXQdb/k5snFxWWumIPIYxgTEO++v3CD+nceWgqdRsORNMTY0bnErDlo6RtKMHNJ0HH64DBiXYZYTGzu/g4UePzZvEmT8LXZ0avHQftOb88uQXL8j1s5ArkDg60+Y/eCFhV6QjXl1RtloeV9tWelq9l0rhnHIsClSmUrLBr0xaMM/tFHqsbL1QGgO9iBnPVIYm3iUKAUV0qJRzJWnYpaMFJEZ8TVQMmMT64AlPCQlQbt6o0TXMv7O5Z/TF/nOt8AYdP3a6IVE3FgAAAYRpQ0NQSUNDIHByb2ZpbGUAAHicfZE9SMNAHMVfU6UqFQc7iDhEqA5iFxVxLFUsgoXSVmjVweTSL2jSkKS4OAquBQc/FqsOLs66OrgKguAHiLvgpOgiJf4vKbSI8eC4H+/uPe7eAUKjwlSzKwqommWk4jExm1sVA6/woxcCJjAqMVNPpBcz8Bxf9/Dx9S7Cs7zP/Tn6lbzJAJ9IHGW6YRFvEM9uWjrnfeIQK0kK8TnxpEEXJH7kuuzyG+eiwwLPDBmZ1DxxiFgsdrDcwaxkqMQzxGFF1ShfyLqscN7irFZqrHVP/sJgXltJc53mCOJYQgJJiJBRQxkVWIjQqpFiIkX7MQ//sONPkksmVxmMHAuoQoXk+MH/4He3ZmF6yk0KxoDuF9v+GAMCu0Czbtvfx7bdPAH8z8CV1vZXG8DcJ+n1thY+Aga2gYvrtibvAZc7wNCTLhmSI/lpCoUC8H5G35QDBm+BvjW3t9Y+Th+ADHW1fAMcHALjRcpe93h3T2dv/55p9fcDnmJyuLmxvEUAAA12aVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/Pgo8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA0LjQuMC1FeGl2MiI+CiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiCiAgICB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iCiAgICB4bWxuczpHSU1QPSJodHRwOi8vd3d3LmdpbXAub3JnL3htcC8iCiAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIKICAgeG1wTU06RG9jdW1lbnRJRD0iZ2ltcDpkb2NpZDpnaW1wOjg3ZDJiMTM2LTAwNmMtNDJmNC1iNGJhLTFhOWNlZDkxNWU5NyIKICAgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo4MDVlMTU4Yi1lZDA5LTQxMjYtOTQxNi0xY2Y0NzAzZTE3YzEiCiAgIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoyM2M2NGJmNy1hNTUyLTQyMWQtODhkYy02ZjkxMjE1NzAwOTgiCiAgIGRjOkZvcm1hdD0iaW1hZ2UvcG5nIgogICBHSU1QOkFQST0iMi4wIgogICBHSU1QOlBsYXRmb3JtPSJXaW5kb3dzIgogICBHSU1QOlRpbWVTdGFtcD0iMTc0MTQ5MjE5OTUxMDgwNyIKICAgR0lNUDpWZXJzaW9uPSIyLjEwLjM0IgogICB0aWZmOk9yaWVudGF0aW9uPSIxIgogICB4bXA6Q3JlYXRvclRvb2w9IkdJTVAgMi4xMCIKICAgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyNTowMzowOVQxMTo0OTo1OSswODowMCIKICAgeG1wOk1vZGlmeURhdGU9IjIwMjU6MDM6MDlUMTE6NDk6NTkrMDg6MDAiPgogICA8eG1wTU06SGlzdG9yeT4KICAgIDxyZGY6U2VxPgogICAgIDxyZGY6bGkKICAgICAgc3RFdnQ6YWN0aW9uPSJzYXZlZCIKICAgICAgc3RFdnQ6Y2hhbmdlZD0iLyIKICAgICAgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo2MWQxMGI2Zi01ZTQ2LTQ5NDctYmNlYS0zNGVjY2VjYzk3Y2YiCiAgICAgIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkdpbXAgMi4xMCAoV2luZG93cykiCiAgICAgIHN0RXZ0OndoZW49IjIwMjUtMDMtMDlUMTE6NDk6NTkiLz4KICAgIDwvcmRmOlNlcT4KICAgPC94bXBNTTpIaXN0b3J5PgogIDwvcmRmOkRlc2NyaXB0aW9uPgogPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgIAo8P3hwYWNrZXQgZW5kPSJ3Ij8+9AvAgwAAAAZiS0dEAPwAogA1+MhLDgAAAAlwSFlzAAAuIwAALiMBeKU/dgAAAAd0SU1FB+kDCQMxO7InhX8AAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAABp0lEQVQ4y5WTMWsUQRTHf292vJULx3mFB1pfwK+gIoIiZJoklZWlraBImhQRYnmIfgG/QFrBwULtRPwAgrhgkfqIslzcvZudscjtuGsWo3+YYt6b939/3v+NcIKHxpjnnAFr7R7wDDiuYwJgjAlPNw9I09SLiOoqvvdgi0s3wimS+DhNU1+WpSrLkvrM53PyPGc2m6G15rP9jjFmH3gM9GsCARARlSQJWmuUUvGICCICwLA/5PB91SRBAHl9a8PfGVxBH2WnpLvRhI83d3m0f78Vv3h1ibVWaYBrRUC7DDeakK/fPnkRAoPsHfooo9fr8eLJS7z3OOcYj8fsHGwCoJus3zb2WJwfxPtlEUafMrTWiAhVVZEkSUuJ5h+QJEmcRQjh/wnqYXbmjq+btc5EtWTw9S0rh6ISpdprohbB50N9rh30jvVXu9GVEEKnfADdLA6rTnrxs9PSP7sDqB9uGf12vT4Ay3QNN5rEeD3A5lJFBRc+vFHGGD/dnoZ6K4MovmxPaX2YNvxqi4MCAkBRFLJKnAVfFIVq2Wit3YG70+bn+purv2vgFwezlu+u8A/BAAAAAElFTkSuQmCC)}input::-webkit-calendar-picker-indicator{display:none!important}input[type=text]::-moz-list-dropdown{display:none!important}input::-ms-clear,input::-ms-reveal{display:none!important}.header h1{margin-bottom:unset}.header span{display:block}.info{display:flex;flex-wrap:wrap}.info a{color:#f91880;text-decoration:underline}.info span:first-of-type,span.info{display:block;font-style:italic}.info span{display:inline;margin-right:15px;font-style:italic}.info span:last-of-type{margin-right:0}.sliders{display:flex;gap:8%;margin-bottom:7.5px;flex-wrap:wrap}label{position:relative;width:36px;height:18px;min-width:36px}label input{opacity:0;width:0;height:0}input:checked+.slider{background-color:#b9b48c}input:checked+.slider:before{-webkit-transform:translateX(18px);-ms-transform:translateX(18px);transform:translateX(18px)}.slider{cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:#69c3c8;border-radius:9px}.slider:before{content:"";height:10px;width:10px;left:4px;bottom:4px;background-color:#fff;border-radius:50%}.directory-path{color:#fff;text-shadow:1px 1px 0 #555,-1.5px 1px 0 #555,1.5px -1px 0 #555,-1px -1px 0 #555}.directory-path a{text-shadow:none}.directory-header{width:calc(90% - 12px)!important;padding:0 8px;background-color:#ff8dd3!important;box-shadow:inset 0 0 0 1px #ff79cb;color:#fff}.directory-header:hover{color:#ebebeb}.directory-header span{all:unset!important;color:#555!important}.directory-header:hover span{color:#000!important}@media (pointer:coarse){body{-webkit-tap-highlight-color:transparent}a{transition:color .2s}a:hover{color:#555}a:active{color:#303030}.drive a:hover{color:#fff;background-color:#71d2d7}.drive a:active{background-color:#b9b48c}ul#files li a,ul#files li:nth-child(2n) a{transition:background-color .2s}ul#files li a:focus,ul#files li a:hover{background-color:unset}ul#files li a:active{background-color:#f9f8f8}ul#files li:nth-child(2n) a:active{background-color:#e0e0e0}.directory-header,.directory-header span{user-select:none;transition:color .2s}.directory-header:hover{color:#fff}.directory-header:hover span{color:#555!important}.directory-header:active{color:#ebebeb}.directory-header:active span{color:#000!important}}@media (min-width:769px){#files.show-date>li>a,#files.show-size>li>a{display:flex;justify-content:space-between}#files.show-date>li>a>.name{width:50%}#files.show-date>li>a>.date{display:block;width:50%;text-align:right}#files.show-date>li>a>.size,#files.show-size>li>a>.date{display:none}#files.show-size>li>a>.name{width:65%}#files.show-size>li>a>.size{display:block;width:35%;text-align:right}#files.show-date.show-size>li>a>.name{width:41.66%}#files.show-date.show-size>li>a>.date{display:block;width:41.66%;text-align:right}#files.show-date.show-size>li>a>.size{display:block;width:16.66%;text-align:right}}@media (max-width:768px){#search,.directory h1,ul#files li{font-size:2em;margin:0}#files .name,ul#files li{float:none;text-indent:0}body{font-size:13px;line-height:16px;padding:0}#search{position:static;width:100%;line-height:1.8em;text-indent:10px;border:0;border-radius:0;padding:10px 0}#search:focus{width:100%;border:0;opacity:1}.directory h1{line-height:1.5em;color:#fff;padding:15px 10px;background:#ff8dd3}ul#files{border-top:1px solid #cacaca}ul#files li{width:auto!important;display:block;border-bottom:1px solid #cacaca;line-height:1.2em}ul#files li:nth-child(odd){background:#e0e0e0}ul#files li a{height:auto;border:0;border-radius:0;padding:15px 10px}ul#files li a:focus,ul#files li a:hover{border:0}#files .date,#files .header,#files .size{display:none!important}#files .name{display:inline-block;width:100%;background-position:0 50%}#files .icon .name{text-indent:41px}.drive,.header,.sliders{margin-bottom:0}.drive{gap:0;width:unset}.drive a{width:50%;min-width:unset;border-radius:0}.drive-br{display:none}.header{padding:5px 10px 10px}.header h1{color:unset;background:unset;padding:0}.header>span{margin:0}.sliders{padding:0 10px}.sliders>div{margin-bottom:5px;display:flex;align-items:center;gap:.5em}#files.show-date>li>a>.date,#files.show-size>li>a>.size{display:block!important;font-size:.7em;text-indent:41px;line-height:1}#files{border-color:#ff79cb!important}.directory-path{text-shadow:none}.directory-header{padding:15px 10px;box-shadow:unset}}"""

def get_icon_preset(extension):
    """Determine the icon preset for a given file extension"""
    for preset, extensions in ICON_PRESETS.items():
        if extension in extensions:
            return f'icon-{preset}'
    return 'icon-default' if USE_DEFAULT_PRESET else ''  # Use default preset based on setting

def get_directory_size(path, excluded_files=None):
    """Calculate total size of a directory including all subdirectories"""
    if excluded_files is None:
        excluded_files = []
    total_size = 0
    for dirpath, dirnames, filenames in os.walk(path):
        filtered_files = [f for f in filenames if f not in excluded_files]
        for filename in filtered_files:
            file_path = os.path.join(dirpath, filename)
            if os.path.isfile(file_path):
                total_size += os.path.getsize(file_path)
    return total_size

def get_directory_id(path):
    """Generate a directory ID based on the full path hierarchy"""
    if path == "." or path == "..":
        return ""
        
    # Split the path into components
    parts = path.split(os.sep)
    if parts[0] == '.':
        parts = parts[1:]  # Remove the leading '.' if present
        
    # Build the ID by tracking level and index for each part
    current_id = []
    for level, _ in enumerate(parts):
        # For each level, we need to find this directory's index among its siblings
        parent_path = os.path.join(*parts[:level]) if level > 0 else "."
        siblings = sorted([d for d in os.listdir(parent_path) 
                         if os.path.isdir(os.path.join(parent_path, d))])
        index = siblings.index(parts[level])
        
        # Generate this level's ID component
        letter = chr(ord('a') + level)
        current_id.append(f"{letter}{index + 1}")
    
    return "".join(current_id)

def process_directory(path, is_root=False, level=0, index=0):
    """Process a directory and return its content"""
    excluded_files = ['snap.py', 'snap.html', 'directories.json'] if is_root else []
    items = os.listdir(path)
    
    if is_root:
        items = [item for item in items if item not in excluded_files]
        
    result = []
    
    # Add parent directory entry
    result.append({
        "type": "directory",
        "name": "..",
        "date": "",
        "date_formatted": "",
        "size": "",
        "size_formatted": "",
        "path": ".."
    })
    
    # Process directories first
    for item in sorted(items):
        full_path = os.path.join(path, item)
        if os.path.isdir(full_path):
            mtime = os.path.getmtime(full_path)
            dir_size = get_directory_size(full_path, excluded_files)
            relative_path = os.path.relpath(full_path, '.')
            directory_id = get_directory_id(relative_path) if item != ".." else ""
            result.append({
                "type": "directory",
                "name": item,
                "date": mtime if mtime else "N/A",
                "date_formatted": format_date(mtime) if mtime else "N/A",
                "size": dir_size,
                "size_formatted": format_size(dir_size),
                "path": relative_path,
                "directory_id": directory_id
            })
    
    # Process files
    for item in sorted(items):
        full_path = os.path.join(path, item)
        if os.path.isfile(full_path):
            extension = item.split('.')[-1] if '.' in item else ''
            icon_preset = get_icon_preset(extension)
            icon_classes = f'icon icon-{extension}'
            if icon_preset:
                icon_classes += f' {icon_preset}'
            
            file_size = os.path.getsize(full_path)
            file_date = os.path.getmtime(full_path)
            
            result.append({
                "type": "file",
                "name": item,
                "date": file_date if file_date else "N/A",
                "date_formatted": format_date(file_date) if file_date else "N/A",
                "size": file_size if file_size else "N/A",
                "size_formatted": format_size(file_size) if file_size else "N/A",
                "icon_classes": icon_classes
            })
    
    return result

def format_size(size):
    """Convert size in bytes to human readable format with 2 decimal points"""
    if not size:
        return "N/A"
    for unit in ['B', 'KB', 'MB', 'GB', 'TB']:
        if size < 1024.0:
            return f"{size:.2f} {unit}"
        size /= 1024.0
    return f"{size:.2f} PB"

def format_date(timestamp):
    """Convert Unix timestamp to readable date format"""
    if not isinstance(timestamp, (int, float)):
        return "N/A"
    from datetime import datetime
    return datetime.fromtimestamp(timestamp).strftime('%d/%m/%Y %I:%M %p')

def animate_message(message, stop_event):
    """Display an animated message with cycling dots until stopped"""
    while not stop_event.is_set():
        for i in range(4):
            if stop_event.is_set():
                break
            dots = '.' * i
            # Print message with varying dots, then return to start of line
            sys.stdout.write(f"\r{message}{dots}{' ' * (3-i)}")
            sys.stdout.flush()
            time.sleep(0.3)
    # Clear the line for the next message
    sys.stdout.write("\r" + " " * (len(message) + 3) + "\r")
    sys.stdout.flush()

def generate_html():
    """Generate the HTML for root directory and JSON for subdirectories"""
    excluded_files = ['snap.py', 'snap.html', 'directories.json']
    
    # Create a stop event for the animation
    animation_stop = threading.Event()
    
    # Start animation in a separate thread
    animation_thread = threading.Thread(
        target=animate_message, 
        args=("Processing root directory", animation_stop)
    )
    animation_thread.daemon = True
    animation_thread.start()
    
    try:
        # Process root directory with level 0 (will give 'a' prefixed IDs)
        root_content = process_directory('.', is_root=True, level=0)
    finally:
        # Stop the animation
        animation_stop.set()
        animation_thread.join()
    
    print("Counting directories and files...")
    
    # Get script path and extract drive letter and folder name
    script_path = os.path.abspath(__file__)
    drive_letter, _ = os.path.splitdrive(script_path)
    folder_name = os.path.basename(os.path.dirname(script_path))
    
    # Get drive label
    drive_label = win32api.GetVolumeInformation(drive_letter + "\\")[0]
    drive_name = drive_letter.rstrip(":\\")
    
    # First do a quick walk to count directories for the progress bar
    print("Calculating statistics...")
    all_dirs = []
    for dirpath, dirnames, _ in os.walk('.'):
        all_dirs.append(dirpath)
    
    # Count total files, folders and size
    total_files = 0
    total_folders = -1  # Start at -1 to not count the root directory
    total_size = 0
    
    for dirpath, dirnames, filenames in tqdm(os.walk('.'), total=len(all_dirs), desc="Processing directories"):
        total_folders += len(dirnames)  # Count all subdirectories
        
        # Filter out excluded files before counting
        filtered_files = [f for f in filenames if f not in excluded_files]
        total_files += len(filtered_files)
        
        for filename in filtered_files:
            file_path = os.path.join(dirpath, filename)
            if os.path.isfile(file_path):
                total_size += os.path.getsize(file_path)
    
    # Get current date/time in the same format as file dates
    date_ran = datetime.now().strftime('%d/%m/%Y %I:%M %p')
    
    # Get version timestamp in YYMMDD.HHMM format
    version = datetime.now().strftime('%y%m%d.%H%M')
    
    # Initialize html_content with the header
    html_content = [f'''<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>{drive_label} {drive_name}:/{folder_name}</title>
    <link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IB2cksfwAAAARnQU1BAACxjwv8YQUAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAAuIwAALiMBeKU/dgAAAAd0SU1FB+kEGhUqK+6BpSIAAAF/SURBVDjL1ZMxa1RBFIW/eb5HEnVjoaQSAiYEBEW0SRkERRTByl5/heBP8KfYpJMIoq1gCv+AYDoxCwu7+3bfvnvnHot9u+42gpU47cz5zrkzZ+C/Xwng2clH7V/ZpkhpZUucjWrePjxKfwKUAEVKvDm8R1oAJEiJwWzGzdOvkn4LelWJSby+ezstAQIsxPH3MwAuliWXygsc7lzj1Z1bCBBCEgK2ypIv7z/p+NH9VC7msAiKlJDEj8mUftPw+Wefna1NPIRH4BJZ4uXBHrE6goAmZzyCiWcGbcvT3evsb/c6vAjR5YDLVUWxfgdwdXOD5zd2lwez4LxpOD3vMzZnbE7tztSdFwd7aC2BoM2Zb8MRY3Mm7ozMGZpRm80B7tTmTHOmDa2/AoBLDGYtY/fOcS4cmVF34nmCTFasAwRIYmjGaEVcmzH2eaKF+ywHKwHmgOjcE7BRFFBVbBQFvaqkjcBCWGQsREg0ORNdOZYte/zug/6mwgJOnjxI//4z/QJdu/wxmuoQUgAAAABJRU5ErkJggg==">
    <style>{CSS_STYLE}</style>
    <script defer>
        (function() {{
            var script = atob("{JS_SCRIPT}");
            eval(script);
        }})();
    </script>
</head>
<body class="directory">
    <input id="search" class="regex-search" type="text" placeholder="Search" autocomplete="off" list="search-patterns">
    <datalist id="search-patterns">
      <option value=">* ">
      <option value=">*file ">
      <option value=">*folder ">
    </datalist>    <div id="wrapper">
      <div class="header">
        <h1>
          {drive_label} {drive_name}:/{folder_name}
        </h1>
        <span>{total_files} files in {total_folders} folders ({format_size(total_size)})</span>
        <span class="info">Generated with <a href="https://github.com/4163/snap" target="_blank">snap</a> at {date_ran}</span>
        <span class="info">Search patterns:</span>
        <div class="info">
          <span>Everything: [ >* item-name ]</span>
          <span>Folders only: [ >*folder item-name ]</span>
          <span>Files only: [ >*file item-name ]</span>
        </div>
      </div>
      <div class="sliders">
        <div>
          <label>
            <input type="checkbox" class="date-toggle" id="date-toggle" name="date-toggle">
            <span class="slider" id="slider-date"></span>
          </label>
          <span>Show date modified</span>
        </div>
        <div>
          <label>
            <input type="checkbox" class="size-toggle" id="size-toggle" name="size-toggle">
            <span class="slider" id="slider-size"></span>
          </label>
          <span>Show file size</span>
        </div>
      </div>      
      <h1 class="directory-path">
        <a href="/">~</a> / 
      </h1>''']
    
    # Add the files list after the header
    html_content.append('      <ul id="files" class="view-tiles" data-path="root">')
    for item in root_content:
        if item["type"] == "directory":
            # Skip the parent directory entry in HTML output
            if item["name"] == "..":
                continue
                
            html_content.append(
                f'        <li><a href="{item["path"]}" class="icon icon-directory" title="{item["name"]}">'
                f'<span class="name">{item["name"]}</span>'
                f'<span class="date">{item["date_formatted"]}</span>'
                f'<span class="size">{item["size_formatted"]}</span></a></li>'
            )
        else:  # file
            size_formatted = format_size(item["size"]) if item["size"] != "N/A" else "N/A"
            html_content.append(
                f'        <li><a href="/" class="{item["icon_classes"]}" title="{item["name"]}">'
                f'<span class="name">{item["name"]}</span>'
                f'<span class="date">{item["date_formatted"]}</span>'
                f'<span class="size">{size_formatted}</span></a></li>'
            )
    html_content.append('      </ul>')
    # Add a script tag with empty JSON data for client-side use
    html_content.append('      <script id="dom-cache" type="application/json"></script>')
    html_content.append('    </div>')
    html_content.append('</body>')
    html_content.append('</html>')
    html_content.append('')
    
    # Use constants for date and size preferences
    keep_raw_date = JSON_OUTPUT['keep_raw_date']
    keep_raw_size = JSON_OUTPUT['keep_raw_size']
    
    # Always minify without asking
    should_minify = True
    
    # Process and store subdirectories in JSON
    subdirs_data = {
        "version": version,
        "directories": {}
    }
    
    # Start with level 1 for actual subdirectories
    current_level = 1
    # Add the root directory to the JSON data
    subdirs_data["directories"]["."] = root_content
    
    # Process remaining directories with progress bar
    print("Processing subdirectories...")
    remaining_dirs = [d for d in all_dirs if d != '.']
    for root in tqdm(remaining_dirs, desc="Creating file structure data"):
        directory_content = process_directory(root, level=current_level)
        current_level += 1
        
        # Remove unneeded fields based on user preferences
        for item in directory_content:
            if not keep_raw_date and "date" in item:
                del item["date"]
            if not keep_raw_size and "size" in item:
                del item["size"]
        
        subdirs_data["directories"][os.path.relpath(root, '.')] = directory_content
    
    # Minify the JSON data
    minified_json = json.dumps(subdirs_data, separators=(',', ':'))
    
    # Replace the empty script tag with one containing the JSON data
    html_content[html_content.index('      <script id="dom-cache" type="application/json"></script>')] = f'      <script id="dom-cache" type="application/json">{minified_json}</script>'
    
    # Write HTML to file
    print("Writing HTML file...")
    with open('snap.html', 'w', encoding='utf-8') as f:
        f.write('\n'.join(html_content))
    
    # CSS and JS are now directly embedded in the HTML
    print("CSS and JS directly embedded...")
    
    # Print summary of choices
    print("Processing complete!")
    
    # Final message and wait for user to press Enter
    print("\nDone!\nPress 'Enter' to exit.")
    input()

if __name__ == '__main__':
    generate_html()